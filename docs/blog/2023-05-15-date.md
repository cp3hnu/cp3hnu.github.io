---
pageClass: blog-page
title: Date è¯¦è§£
tags:
  - web
  - javascript
date: 2023-05-15
author: cp3hnu
location: ChangSha
summary: åœ¨å®é™…çš„åº”ç”¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ° Date ç±»å‹ï¼Œå°¤å…¶æ˜¯ Date ç±»å‹ä¸ String ç±»å‹äº’ç›¸è½¬æ¢ã€‚ä½†æ˜¯å› ä¸ºæ—¥æœŸçš„è¡¨ç¤ºå½¢å¼å¤šç§å¤šæ ·ï¼Œæ‰€ä»¥ä¸€ä¸å°å¿ƒå¯èƒ½å°±ä¼šå‡ºé”™ï¼Œå°¤å…¶æ˜¯æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« å°†è¯¦ç»†è®²è§£ Date ç±»å‹ï¼Œé‡ç‚¹æ˜¯ Date ç±»å‹ä¸ String ç±»å‹ä¹‹é—´çš„è½¬æ¢ã€‚
---

# Date è¯¦è§£

åœ¨å®é™…çš„åº”ç”¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ° Date ç±»å‹ï¼Œå°¤å…¶æ˜¯ Date ç±»å‹ä¸ String ç±»å‹äº’ç›¸è½¬æ¢ã€‚ä½†æ˜¯å› ä¸ºæ—¥æœŸçš„è¡¨ç¤ºå½¢å¼å¤šç§å¤šæ ·ï¼Œæ‰€ä»¥ä¸€ä¸å°å¿ƒå¯èƒ½å°±ä¼šå‡ºé”™ï¼Œå°¤å…¶æ˜¯æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« å°†è¯¦ç»†è®²è§£ Date ç±»å‹ï¼Œé‡ç‚¹æ˜¯ Date ç±»å‹ä¸ String ç±»å‹ä¹‹é—´çš„è½¬æ¢ã€‚

## UTC

**UTC** å³[åè°ƒä¸–ç•Œæ—¶](https://zh.wikipedia.org/wiki/%E5%8D%8F%E8%B0%83%E4%B8%96%E7%95%8C%E6%97%B6)ï¼ˆCoordinated Universal Timeï¼‰ï¼Œæ˜¯åŸºäºåŸå­é’Ÿçš„å›½é™…æ ‡å‡†æ—¶é—´ã€‚UTC ä½¿å¾—ä¸åŒçš„åœ°åŒºå’Œç³»ç»Ÿèƒ½å¤Ÿç»Ÿä¸€åœ°è§£è¯»æ—¶é—´ã€‚

UTC è¡¨ç¤ºçš„æ˜¯æœ¬åˆå­åˆçº¿ï¼ˆå³ 0 åº¦ç»çº¿ï¼‰çš„æ—¶é—´ï¼Œ è€Œä¸–ç•Œå„åœ°çš„æ—¶é—´æ˜¯ä»¥æœ¬åˆå­åˆçº¿çš„æ—¶é—´ä¸ºåŸºå‡†ï¼Œå†åŠ ä¸Šå„è‡ªæ‰€åœ¨çš„æ—¶åŒºã€‚æ¯”å¦‚ï¼ŒåŒ—äº¬å¤„åœ¨ä¸œå…«åŒºï¼Œæ¯”æœ¬åˆå­åˆçº¿çš„æ—¶é—´å¿« 8 ä¸ªå°æ—¶ï¼Œä¹Ÿå°±æ˜¯ UTC + 8ã€‚

**Date** å…¶å®å°±æ˜¯å°è£…äº†ä¸€ä¸ªæ•´æ•°çš„å¯¹è±¡ï¼Œè¿™ä¸ªæ•´æ•°è¡¨ç¤ºçš„æ˜¯ä» UTC 1970-01-01 00:00:00 å¼€å§‹çš„æ¯«ç§’æ•°ã€‚

## GMT

**GMT** å³[æ ¼æ—å°¼æ²»æ ‡å‡†æ—¶é—´](https://zh.wikipedia.org/zh-cn/%E6%A0%BC%E6%9E%97%E5%B0%BC%E6%B2%BB%E6%A8%99%E6%BA%96%E6%99%82%E9%96%93)ï¼ˆGreenwich Mean Timeï¼‰ï¼Œåˆç§°æ ¼æ—å°¼æ²»å¹³å‡æ—¶é—´ï¼Œæ˜¯æŒ‡ä½äºè‹±å›½ä¼¦æ•¦éƒŠåŒºçš„çš‡å®¶æ ¼æ—å°¼æ²»å¤©æ–‡å°å½“åœ°çš„å¹³å¤ªé˜³æ—¶ï¼Œå› ä¸ºæœ¬åˆå­åˆçº¿è¢«å®šä¹‰ä¸ºé€šè¿‡é‚£é‡Œçš„ç»çº¿ã€‚

ç”±äºåœ°çƒæ¯å¤©çš„è‡ªè½¬æ˜¯æœ‰äº›ä¸è§„åˆ™çš„ï¼Œè€Œä¸”æ­£åœ¨ç¼“æ…¢å‡é€Ÿï¼Œå› æ­¤ GMT å¹³æ—¶åŸºäºå¤©æ–‡è§‚æµ‹æœ¬èº«çš„ç¼ºé™·ï¼Œç›®å‰å·²ç»è¢« UTC æ‰€å–ä»£ã€‚

GMT å’Œ UTC æ—¶é—´å¾ˆæ¥è¿‘ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªé“¾æ¥ï¼š[UTC](https://time.is/UTC)ã€[GMT](https://time.is/GMT)ï¼Œçœ‹çœ‹ UTC å’Œ GMT ä¹‹é—´çš„å·®åˆ«

## ISO 8601 Extended Format

æ—¥æœŸçš„è¡¨ç¤ºæ–¹å¼æœ‰å¤šç§å¤šæ ·ï¼Œè€Œä¸”æ¯ä¸ªå›½å®¶çš„è¡¨ç¤ºæ–¹å¼ä¹Ÿå„ä¸ç›¸åŒï¼Œæ¯”å¦‚ 2023 å¹´ 5 æœˆ 15 æ—¥ï¼Œæœ‰çš„å›½å®¶æ˜¯è¿™æ ·è¡¨ç¤ºçš„ï¼šMay 15, 2023ï¼Œè€Œæœ‰çš„å›½å®¶æ˜¯è¿™æ ·è¡¨ç¤ºçš„ï¼š2023/05/15ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªé€šç”¨çš„æ—¥æœŸæ ¼å¼ã€‚

ISO 8601 å®šä¹‰äº†å›½é™…é€šç”¨çš„æ—¥æœŸæ ¼å¼ï¼š**YYYY-MM-DDTHH:mm:ss.sssZ**

|      | è¯´æ˜                                                         | é»˜è®¤å€¼   |
| ---- | ------------------------------------------------------------ | -------- |
| YYYY | å¹´ï¼Œ4ä½æ•°å­—ï¼Œ0000~9999                                       | required |
| MM   | æœˆï¼Œ2ä½æ•°å­—ï¼Œ01~12                                           | 01       |
| DD   | æ—¥ï¼Œ2ä½æ•°å­—ï¼Œ01~31                                           | 01       |
| T    | æ—¥æœŸå’Œæ—¶é—´çš„åˆ†éš”ç¬¦                                           | 01       |
| HH   | æ—¶ï¼Œ2ä½æ•°å­—ï¼Œ00~23ï¼Œç‰¹æ®Šçš„ä¸€ä¸ªæ˜¯ 24:00:00 è¡¨ç¤ºç¬¬äºŒå¤©çš„å‡Œæ™¨   | 00       |
| mm   | åˆ†ï¼Œ2ä½æ•°å­—ï¼Œ00~59                                           | 00       |
| ss   | ç§’ï¼Œ2ä½æ•°å­—ï¼Œ00~59                                           | 00       |
| sss  | æ¯«ç§’ï¼Œ3ä½æ•°å­—ï¼Œ00~999                                        | 000      |
| Z    | è¡¨ç¤º UTC æ—¶é—´ï¼ˆæ— åç§»ï¼‰ï¼Œåç§»é‡çš„æ ¼å¼ä¸ºï¼š`+ï¼ˆ-ï¼‰HH:mm`ï¼ŒèŒƒå›´ä¸º [-23:59 ~ +23:59] | -        |

ç¤ºä¾‹å¦‚ä¸‹ï¼š

![](./assets/date-iso-8601.png)



UTC åç§»é‡è¡¨ç¤ºæœ¬åœ°æ—¶é—´æ—©äºæˆ–æ™šäº UTC å‡ å°æ—¶å‡ åˆ†é’Ÿï¼Œåœ¨å®é™…çš„åº”ç”¨ä¸­åŸºæœ¬ä¸Šç”¨æ¥è¡¨ç¤ºæ—¶åŒºï¼Œæ¯”å¦‚åŒ—äº¬åœ¨ä¸œå…«åŒºï¼Œåˆ™è¡¨ç¤ºä¸º `+08:00`ã€‚

## String è½¬ Date

åœ¨å®é™…çš„åº”ç”¨å¼€å‘ä¸­ï¼Œæœ€å¸¸ç”¨çš„å°±æ˜¯ String è½¬ Dateï¼Œæ¯”å¦‚ä»åå°è·å–ä¸ªäººçš„å‡ºç”Ÿæ—¥æœŸï¼Œç„¶ååˆ¤æ–­è¿™ä¸ªäººç°åœ¨æ˜¯å¤šå°‘å²äº†ï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠ String è½¬æ¢æˆ Dateã€‚Date å¯¹è±¡æä¾›ä¸¤ä¸ªæ–¹æ³•å°† String è½¬æ¢æˆ Dateã€‚ä¸€ä¸ªæ˜¯ Date æ„é€ å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯ `Date.parse` é™æ€æ–¹æ³•ã€‚å®ƒä»¬æ¥å—å­—ç¬¦ä¸²çš„æ ¼å¼æ˜¯ä¸€è‡´çš„ã€‚

é‚£ä¹ˆä»€ä¹ˆæ ·çš„å­—ç¬¦ä¸²èƒ½æˆåŠŸè½¬æ¢æˆ Date å‘¢ï¼Ÿç­”æ¡ˆæ˜¯åªæœ‰ **ISO 8601 Extended Format** æ˜¯æ˜ç¡®æ”¯æŒçš„æ ¼å¼ï¼Œå…¶å®ƒæ ¼å¼çš„å­—ç¬¦ä¸²ä¸ä¿è¯æ‰€æœ‰çš„æµè§ˆå™¨éƒ½æ”¯æŒï¼Œæ¯”å¦‚ [RFC-2822](https://datatracker.ietf.org/doc/html/rfc2822#section-3.3)ã€‚

> ğŸ“¢ MDN: Only the [date time string format](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date#date_time_string_format) is explicitly specified to be supported. Other formats are implementation-defined and may not work across all browsers.

```js
const date = new Date("2023-05-15T10:41:43.975+08:00") // 2023-05-15T02:41:43.975Z
const timestamp = Date.parse("2023-05-15T10:41:43.975+08:00") //1684118503975
```

### ISO 8601 æ ¼å¼

ECMAScript æ”¯æŒä¸‹é¢è¿™äº›æ—¥æœŸæ ¼å¼

- YYYY
- YYYY-MM
- YYYY-MM-DD

åŒæ—¶ä¹Ÿæ”¯æŒä¸Šé¢çš„æ—¥æœŸæ ¼å¼ä¸ä¸‹é¢çš„æ—¶é—´æ ¼å¼çš„ç»„åˆ

- THH:mm
- THH:mm:ss
- THH:mm:ss.sss

ä¸‹é¢æ˜¯æœ‰æ•ˆçš„æ—¥æœŸæ ¼å¼

```js
new Date("2023"); 
new Date("2023-05"); 
new Date("2023-05-15"); 
new Date("2023-05-15T10:10"); 
new Date("2023-05-15T10:10:10");
new Date("2023-05-15T10:10:10.100");
new Date("2023-05-15T10:10:10.100Z");
new Date("2023-05-15T10:10:10.100+08:00");
```

UTC åç§»é‡æ˜¯å¯ä»¥çœç•¥çš„ï¼Œä½†æ˜¯å¦‚æœçœç•¥äº† UTC åç§»é‡ï¼Œè§£æå­—ç¬¦ä¸²æ—¶æœ‰æ‰€åŒºåˆ«ï¼š

- å¦‚æœæ˜¯å¸¦æ—¶åˆ†ç§’çš„ "date-time" å­—ç¬¦ä¸²ï¼Œåˆ™è¢«è§£ææˆæœ¬åœ°æ—¶é—´ï¼Œä¾‹å¦‚ "2023-05-15T10:41:53"ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰ è¢«è§£ææˆ "2023-05-15T02:41:53.000Z"
- å¦‚æœåªæœ‰å¹´æœˆæ—¥çš„ date å­—ç¬¦ä¸²ï¼Œåˆ™è¢«è§£ææˆ UTC æ—¶é—´ï¼Œä¾‹å¦‚ï¼Œ"2023-05-15" è¢«è§£ææˆ "2023-05-15T00:00:00.000Z"ã€‚è¿™ç§æƒ…å†µè¦å°å¿ƒï¼Œå› ä¸º `Date.getDate` è¿™ç±» API è¿”å›çš„æ˜¯æœ¬åœ°æ—¶é—´ï¼Œå¯èƒ½å’Œä½ æƒ³è¦çš„ç»“æœä¸ä¸€è‡´ã€‚æ‰€ä»¥å¦‚æœä½ æƒ³è¦çš„æ˜¯æœ¬åœ°æ—¶é—´ï¼Œè¦åœ¨åé¢æ·»åŠ  "T00:00:00" å†è½¬æ¢æˆ Date

```js
const date1 = new Date("2023-05-15")          // 2023-05-15T00:00:00.000Z
const date2 = new Date("2023-05-15T00:00:00") // 2023-05-14T16:00:00.000Z
```

ISO 8601 æ ¼å¼ä¸­å…·ä½“å“ªäº›å­—ç¬¦ä¸²èƒ½æˆåŠŸè½¬æ¢æˆ Dateï¼Œè¯·å‚è€ƒ [Demo](https://gitee.com/cp3hnu/web-demo/tree/master/date-demo)

æˆ‘åœ¨æµ‹è¯•ï¼ˆSafari 16.3 / Chrome 114 / Node 16.14.0 ï¼‰ä¸­è¿˜å‘ç°ï¼š

- å¯ä»¥ä½¿ç”¨ç©ºæ ¼ä»£æ›¿ "T"ï¼ŒAI å‘Šè¯‰æˆ‘ **ç°ä»£æµè§ˆå™¨** éƒ½æ”¯æŒè¿™ç§æ–¹å¼
- UTC åç§»é‡ä¸­é—´çš„å†’å·ï¼ˆ:ï¼‰å¯ä»¥çœç•¥ï¼Œå³ `+0800` ä¹Ÿæ˜¯å¯ä»¥çš„
- æ¯«ç§’ä¸è¶³ 3 ä½çš„ï¼Œåé¢è¡¥ 0ï¼›è¶…è¿‡ 3 ä½çš„æˆªæ–­
- åªæœ‰å¹´æœˆæ—¥çš„å­—ç¬¦ä¸²ä¸èƒ½å¸¦æœ‰åç§»é‡ï¼Œå³ "2023-05-15+08:00"/"2023-05-15+00:00" ä¸èƒ½è½¬æ¢æˆ Date

ä¸‹é¢æ˜¯ ISO 8601 éæ ‡å‡†æ ¼å¼å­—ç¬¦ä¸²åœ¨ä¸åŒç¯å¢ƒä¸­çš„å·®å¼‚

|                                    | Chrome/Node                    | Safari |
| ---------------------------------- | ------------------------------ | ------ |
| å¹´è¶…è¿‡ 4 ä½ï¼Œä¾‹å¦‚ 20231            | æœ‰æ•ˆï¼Œä½†æ˜¯è¾“å‡ºæœ¬åœ°æ—¶é—´çš„åˆå¤œ   | æœ‰æ•ˆ   |
| å¹´ä¸è¶³ 4 ä½ï¼Œä¾‹å¦‚ 202              | æœ‰æ•ˆï¼Œä½†æ˜¯è¾“å‡ºæœ¬åœ°æ—¶é—´çš„åˆå¤œ   | æœ‰æ•ˆ   |
| æœˆã€æ—¥ä¸è¶³ä¸¤ä½ï¼Œ2023-5/2023-05-1   | æœ‰æ•ˆï¼Œä½†æ˜¯è¾“å‡ºæœ¬åœ°æ—¶é—´çš„åˆå¤œ   | æ— æ•ˆ   |
| å¹´è¶…è¿‡ 4 ä½æˆ–ä¸è¶³4ä½ï¼Œåé¢å¸¦æ—¶åˆ†ç§’ | æ— æ•ˆ                           | æœ‰æ•ˆ   |
| æœˆã€æ—¥ä¸è¶³ä¸¤ä½ï¼Œåé¢å¸¦æ—¶åˆ†ç§’       | æ— æ•ˆ                           | æ— æ•ˆ   |
| 2023-02-31                         | æœ‰æ•ˆï¼Œ2023-03-03T00:00:00.000Z | æ— æ•ˆ   |
| 2023-05-15Z                        | æœ‰æ•ˆï¼Œ2023-05-15T00:00:00.000Z | æ— æ•ˆ   |

æ›´å¤šè¯¦æƒ…è¯·å‚è€ƒ [Demo](https://gitee.com/cp3hnu/web-demo/tree/master/date-demo)

### å…¶å®ƒæ ¼å¼

ã€ŠProfessional Javascript for Web Developersã€‹ä¸Šè¯´ ECMA-262 ç¬¬äº”ç‰ˆå®šä¹‰äº† Date è¿˜å¿…é¡»æ”¯æŒä¸‹é¢è¿™äº›æ—¥æœŸæ ¼å¼ï¼š

1. month/date/year (such as 5/23/2019)

2. month_name date, year (such as May 23, 2019)

3. [day_of_week] month_name date year (such as Tue May 23 2019)

ä¸Šé¢è¿™äº›åé¢éƒ½å¯ä»¥æ·»åŠ  time-format: `hours:minutes:seconds time_zone`

ä¸‹é¢éƒ½æ˜¯æœ‰æ•ˆçš„æ—¥æœŸæ ¼å¼ï¼ˆåœ¨ Safari 16.3 / Chrome 114 / Node 16.14.0 æµ‹è¯•é€šè¿‡ï¼‰

```js
new Date("2023/05/15");                  // 2023-05-14T16:00:00.000Z
new Date("2023/05/15 10:10:10 +08:00");

new Date("May 15, 2019");
new Date("May 15, 2019 10:10:10 GMT+0800");

new Date("May 15 2019");
new Date("May 15 2019 10:10:10 UTC+08:00");
new Date("Sun May 15 2019 10:10:10");
new Date("ABC May 15 2019 10:10:10");    // `day_of_week` å¯é€‰ï¼Œä¸”ä»€ä¹ˆå­—ç¬¦éƒ½å¯ä»¥
new Date("Sun MayABC 15 2019 10:10:10"); // `month_name` å‰3ä½æ‹¼å†™æ­£ç¡®å³å¯ï¼Œä¸”å¤§å°å†™æ— å…³
```

æœ‰å‡ ç‚¹è¯´æ˜ï¼š

- åªæœ‰å¹´æœˆæ—¥çš„å­—ç¬¦ä¸²ï¼Œè¢«è§£æä¸ºæœ¬åœ°æ—¶é—´çš„åˆå¤œï¼Œè¿™ä¸ªä¸ ISO 8601 æ ¼å¼æœ‰æ‰€åŒºåˆ«ï¼Œ ISO 8601 è§£æçš„æ˜¯ UTC æ—¶é—´çš„åˆå¤œ
- Safari ä¸æ”¯æŒå¾®ç§’ï¼Œä¾‹å¦‚ `2023/05/05 10:10:10.123` æ— æ•ˆ
- æ—¶åŒºçš„è¡¨ç¤ºå½¢å¼ä¸ºï¼š`[WS] +(-)HH[:]mm` æˆ–è€… `WS GMT(UTC)+(-)HH[:]mm` æˆ–è€… `Z`
- åœ¨ Safari ä¸­æ—¶åŒºä¸æ”¯æŒ `Z`, åªæœ‰å¹´æœˆæ—¥çš„å­—ç¬¦ä¸²ä¸æ”¯æŒ `+(-)HH[:]mm` ï¼Œä½†æ˜¯æ”¯æŒ`WS +(-)HH[:]mm` å’Œ `WS GMT(UTC)+(-)HH[:]mm` 
- åœ¨ Chrome ä¸­ï¼Œåªæœ‰å¹´æœˆæ—¥çš„å­—ç¬¦ä¸²ä¸æ”¯æŒ `[WS] +(-)HH[:]mm`ï¼Œä½†æ˜¯æ”¯æŒ `WS GMT(UTC)+(-)HH[:]mm` å’Œ `Z`
- ç¬¬ 3 ç§æ ¼å¼ä¸­çš„ `day_of_week` æ— å…³ç´§è¦ï¼Œéšä¾¿ä»€ä¹ˆå­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²éƒ½å¯ä»¥ï¼Œå¯èƒ½ä¸å®ç°æœ‰å…³ï¼Œä¸å¯ä¾èµ–è¿™ç§ç‰¹æ€§ã€‚
- ç¬¬2ã€ 3 ç§æ ¼å¼ä¸­çš„ `month_name` å‰ 3 ä½æ‹¼å†™æ­£ç¡®å°±è¡Œï¼Œä¸”å¤§å°å†™æ— å…³ï¼Œå¯èƒ½ä¸å®ç°æœ‰å…³ï¼Œä¸å¯ä¾èµ–è¿™ç§ç‰¹æ€§ã€‚

> WSï¼šç©ºæ ¼ï¼Œ[]ï¼šå¯é€‰

è¯¦æƒ…è¯·çœ‹ [Demo](https://gitee.com/cp3hnu/web-demo/tree/master/date-demo)

## Date è½¬ String

åœ¨å®é™…çš„åº”ç”¨å¼€å‘ä¸­ï¼Œä¹Ÿå¸¸å¸¸éœ€è¦å°† Date ç±»å‹è½¬ String ç±»å‹ã€‚Date è½¬ String æœ‰å¾ˆå¤š API å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯ä¸€èˆ¬æ˜¯è¦æ±‚è½¬æˆæœ¬åœ°æ—¶é—´ `YYYY-MM-DD HH:mm:ss.sss` æ ¼å¼ã€‚

### ISO 8601 æ ¼å¼

æˆ‘ä»¬çŸ¥é“ Date æä¾›äº†è·å–å„ä¸ªéƒ¨åˆ†å€¼ APIï¼Œæ¯”å¦‚ `getMonth`ã€‚æ‰€ä»¥å¯ä»¥å…ˆè·å– Date å„ä¸ªéƒ¨åˆ†çš„å€¼ï¼Œç„¶åå†æ‹¼æ¥èµ·æ¥ã€‚

```js
const getLocalDateString = (date) => {
  if (!isValidDate(date)) {
    return "";
  }
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, "0");
  const day = String(date.getDate()).padStart(2, "0");
  const hours = String(date.getHours()).padStart(2, "0");
  const minutes = String(date.getMinutes()).padStart(2, "0");
  const seconds = String(date.getSeconds()).padStart(2, "0");
  const milliseconds = String(date.getMilliseconds()).padStart(3, "0");

  return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}.${milliseconds}`;
};
```

è¿™æ˜¯è½¬æ¢æˆæœ¬åœ°æ—¶é—´çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœä½ æƒ³è½¬æ¢æˆ UTC æ—¶é—´çš„å­—ç¬¦ä¸²ï¼Œåªéœ€è¦å°† `getXXX` æ›¿æ¢æˆ `getUTCXXX` å³å¯ã€‚åŒæ—¶ï¼Œå¯¹äºè·å– UTC æ—¶é—´çš„å­—ç¬¦ä¸²ï¼ŒDate è¿˜æä¾›äº† 2 ä¸ªæ–¹ä¾¿çš„ API `toISOString` å’Œ `toJSON`ï¼Œå®ƒä»¬è¿”å›çš„å­—ç¬¦ä¸²æ˜¯ä¸€æ ·çš„ã€‚

```js
const date = new Date("2023-05-15T10:10:10.100")
console.log(date.toISOString()); // "2023-05-15T02:10:10.100Z"
console.log(date.toJSON());      // "2023-05-15T02:10:10.100Z"
```

ä¸Šé¢è¿™ä¸ªå‡½æ•°çš„ç¼ºç‚¹æ˜¯ä¸å¤Ÿçµæ´»ï¼Œå¦‚æœæˆ‘åªæƒ³è¦å…¶ä¸­çš„ä¸€éƒ¨ä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘åªæƒ³è¦å¹´æœˆæ—¥ï¼Œæˆ‘è¿˜éœ€è¦è·å–é‡Œé¢çš„å­å­—ç¬¦ä¸²ã€‚

åƒ `moment` ä¹‹ç±»çš„åº“ï¼Œæä¾›äº†çµæ´»æ ¼å¼åŒ– Date çš„æ–¹å¼ï¼Œæ¯”å¦‚ `moment().format("YYYY-MM-DD")`ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥æä¾›ä¸€ä¸ªç®€åŒ–ç‰ˆï¼š

```js
// YYYY æ”¯æŒ 1~4 ä½
// MMã€DDã€HHã€mmã€ss æ”¯æŒ 1~2 ä½
// S æ¯«ç§’ï¼Œæ”¯æŒ 1~3 ä½
// E æ˜ŸæœŸï¼Œ1 ä½
// Q å­£åº¦ï¼Œ1 ä½
export const formatDate = (format, date) => {
  const o = {
    "Y+": date.getFullYear(), // å¹´
    "M+": date.getMonth() + 1, // æœˆä»½
    "D+": date.getDate(), // æ—¥
    "H+": date.getHours(), // å°æ—¶
    "m+": date.getMinutes(), // åˆ†
    "s+": date.getSeconds(), // ç§’
    "S+": date.getMilliseconds(), // æ¯«ç§’
    E: dayOfWeekCodes[date.getDay()],
    Q: quarterCodes[parseInt(date.getMonth() / 3)], // å­£åº¦
  };
  let result = format;
  for (const k in o) {
    if (Object.prototype.hasOwnProperty.call(o, k)) {
      const match = new RegExp(`(${k})`).exec(result);
      if (match) {
        if (k === "Y+") {
          // å¹´
          result = result.replace(
            match[0],
            String(o[k]).substring(4 - match[0].length)
          );
        } else if (k === "S+") {
          // æ¯«ç§’
          result = result.replace(
            match[0],
            String(o[k]).padStart(3, "0").substring(0, match[0].length)
          );
        } else {
          result = result.replace(
            match[0],
            String(o[k]).padStart(match[0].length, "0")
          );
        }
      }
    }
  }

  return result;
};
```

æ³¨æ„å¯¹æ¯«ç§’çš„å¤„ç†æ–¹å¼ï¼Œå› ä¸ºå­—ç¬¦ä¸²è½¬ Date æ—¶ï¼Œæ¯«ç§’ä½æ˜¯åè¾¹è¡¥ 0ï¼Œä¸ºäº†é˜²æ­¢å­—ç¬¦ä¸²è½¬å› Date æ—¶ä¸ä¸€è‡´ï¼Œæ‰€ä»¥æ¯«ç§’ä»é«˜ä½å¼€å§‹å–å€¼ã€‚

```js
const date = new Date("2023-05-15T10:01:05.012")
const full = formatDate("YYYY-MM-DD HH:mm:ss.SSS", date) // "2023-05-15 10:01:05.012"
const ymd = formatDate("YYYY-MM-DD", date) // "2023-05-15"
const hms = formatDate("HH:mm:ss", date) // "10:01:05"
const ms = formatDate("S", date) // "0"ï¼Œä»é«˜ä½å¼€å§‹å–å€¼
const quarter = formatDate("ç¬¬Qå­£åº¦", date) // "ç¬¬äºŒå­£åº¦"
const dayOfWeek = formatDate("æ˜ŸæœŸE", date) // "æ˜ŸæœŸä¸€"
// short
const fullShort = formatDate("YY-M-D H:m:s", date) // "23-5-15 10:1:5"
```

å¦‚æœä½ æƒ³è¦æ›´å¤šçš„æ ¼å¼è½¬æ¢ï¼Œå¯ä»¥ä½¿ç”¨ [`moment`](https://github.com/moment/moment)ã€[`date-fns`](https://github.com/date-fns/date-fns)ã€[`dayjs`](https://github.com/iamkun/dayjs) ç­‰ç¬¬ä¸‰æ–¹åº“ã€‚

### æœ¬åœ°åŒ–

`toLocaleString`ã€`toLocaleDateString`ã€`toLocaleTimeString` 3 ä¸ª API è¿”å›æœ¬åœ°åŒ–æ—¥æœŸå­—ç¬¦ä¸²ã€‚åœ¨æ”¯æŒ [`Intl.DateTimeFormat`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat) çš„å®ç°ä¸­ï¼Œè¯¥æ–¹æ³•ä»…æ˜¯è°ƒç”¨äº† `Intl.DateTimeFormat` æ–¹æ³•ã€‚

> ğŸ“¢ MDNï¼šå¤§å¤šæ•°æ—¶å€™ï¼Œ`toLocaleString()` è¿”å›çš„æ ¼å¼æ˜¯ä¸€è‡´çš„ã€‚ä½†æ˜¯ï¼Œè¿™å¯èƒ½åœ¨æœªæ¥å‘ç”Ÿå˜åŒ–ï¼Œä¸”ä¸èƒ½ä¿è¯æ‰€æœ‰è¯­è¨€éƒ½èƒ½å¾—åˆ°ä¸€è‡´çš„æ ¼å¼ã€‚è¾“å‡ºçš„å˜åŒ–å› å®ç°è€Œå¼‚ï¼Œè€Œä¸”è¿™ç§å˜åŒ–æ˜¯è§„èŒƒæ‰€å…è®¸çš„ã€‚ä½ ä¸åº”è¯¥å°† `toLocaleString()` çš„ç»“æœä¸é™æ€å€¼ä½œæ¯”è¾ƒã€‚

æ‰€ä»¥è¿™ç§æ–¹å¼å¾—åˆ°çš„å­—ç¬¦ä¸²æ ¼å¼æ˜¯ä¸ç¨³å®šçš„ã€‚åœ¨å®é™…çš„å¼€å‘ä¸­ä¹Ÿä¸å¸¸ç”¨ï¼Œä½†æ˜¯å¯ä»¥äº†è§£ä¸€ä¸‹ã€‚API å¦‚ä¸‹ï¼š

```js
toLocaleString(locales, options)
```

`locales`, `options` å‚æ•°å¯¹åº” `Intl.DateTimeFormat` æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œåœ¨ä¸æ”¯æŒ `Intl.DateTimeFormat` çš„æµè§ˆå™¨ä¸­ï¼Œè¿™ä¸¤ä¸ªå‚æ•°è¢«å¿½ç•¥ï¼Œè¿”å›çš„å­—ç¬¦ä¸²çš„æ ¼å¼å®Œå…¨å–å†³äºå®ç°ã€‚ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒ `Intl.DateTimeFormat`ã€‚

#### `locales`

`locales` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”±ä»¥ä¸‹å†…å®¹ç»„æˆ:

- ç”± 2-3 æˆ– 5-8 ä¸ªå­—æ¯ç»„æˆçš„ language subtagï¼ˆå¯é€‰ï¼‰

- ä¸€ä¸ªå¸¦æœ‰ 4 ä¸ªå­—æ¯çš„ script subtagï¼ˆå¯é€‰ï¼‰

- 2 ä¸ªå­—æ¯æˆ– 3 ä¸ªæ•°å­—çš„ region subtagï¼ˆå¯é€‰ï¼‰ 

- ä¸€ä¸ªæˆ–å¤šä¸ª variant subtag (å¿…é¡»æ˜¯å”¯ä¸€çš„)ï¼Œæ¯ä¸ª variant subtag å¸¦æœ‰ 5-8 ä¸ªå­—æ¯æ•°å­—æˆ– 1 ä¸ªæ•°å­—åé¢è·Ÿç€ 3 ä¸ªå­—æ¯æ•°å­—ï¼ˆå¯é€‰ï¼‰

- ä¸€ä¸ªæˆ–å¤šä¸ªBCP 47 æ‰©å±•åºåˆ—ï¼ˆå¯é€‰ï¼‰

- ç§æœ‰æ‰©å±•åºåˆ—ï¼ˆå¯é€‰ï¼‰

æ›´å¤šè¯¦æƒ…è¯·å‚è€ƒ [locales argument](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl#locales_argument)ã€[Intl.DateTimeFormat() Parameters](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat/DateTimeFormat#parameters)

å¸¸ç”¨çš„æœ‰è¿™äº› [`rfc5646-language-tags.js`](https://gist.github.com/msikma/8912e62ed866778ff8cd#file-rfc5646-language-tags-js)ï¼Œå¯¹äºä¸­å›½å¤§é™†ä¸€èˆ¬ä½¿ç”¨ `zh-CN` æˆ–è€… `zh-Hans-CN`

#### `options`

ç¡®å®š Date å­—ç¬¦ä¸²æ ¼å¼ã€‚æœ‰æ•´ä½“çš„ï¼Œä¹Ÿæœ‰å„ä¸ªéƒ¨åˆ†çš„

**æ•´ä½“çš„ï¼š**

- `dateStyle`
- `timeStyle`
- `calendar`
- `numberingSystem`
- `timeZone`
- `hour12`
- `hourCycle`
- `localeMatcher`
- `formatMatcher`

**å„ä¸ªéƒ¨åˆ†çš„ï¼š**

- `year`
- `month`
- `day`
- `hour`
- `minute`
- `second`
- `fractionalSecondDigits`
- `weekday`
- `dayPeriod`
- `timeZoneName`
- `era`

æ›´å¤šè¯¦æƒ…è¯·å‚è€ƒ [Intl.DateTimeFormat() Parameters](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat/DateTimeFormat#parameters)

#### Demoï¼ˆChome 114ï¼‰

```js
const date = new Date("2023-05-15T23:10:00.100");
// é»˜è®¤ä¸ºæœ¬åœ°
date.toLocaleString();         // 2023/5/15 23:10:00
date.toLocaleString("zh-CN");  // 2023/5/15 23:10:00
date.toLocaleString("zh-CN", { // 2023å¹´5æœˆ15æ—¥æ˜ŸæœŸä¸€ ä¸­å›½æ ‡å‡†æ—¶é—´ 23:10:00
	dateStyle: "full",
  timeStyle: "full",
}); 
date.toLocaleString("zh-CN", { // 2023å¹´5æœˆ15æ—¥ GMT+8 23:10:00
  dateStyle: "long",
  timeStyle: "long",
}); 
date.toLocaleString("zh-CN", { // 2023å¹´5æœˆ15æ—¥ 23:10:00
  dateStyle: "medium",
  timeStyle: "medium",
}); 

date.toLocaleString("zh-CN", { // 2023/5/15 23:10:00
  dateStyle: "short",
  timeStyle: "short",
}); 

// éƒ¨åˆ†ç»„åˆ
date1.toLocaleString("zh-CN", { // 2023/05/15 23:10:00.100
    year: "numeric",
    month: "2-digit",
    day: "2-digit",
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit",
    fractionalSecondDigits: 3
  })
```

> å½“ä½¿ç”¨ä¸åˆæ³•çš„ `locales` å’Œ `options` æ—¶ï¼Œåˆ™ä¼šæŠ›å‡º [`RangeError`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RangeError) å¼‚å¸¸

### å…¶å®ƒè½¬å­—ç¬¦ä¸² API

ä¸‹é¢è¿™ 4 ä¸ªAPI åŸºæœ¬ä¸Šä¸ä¼šç”¨åˆ°

`toString`ã€`toDateString`ã€`toTimeString` è¿”å›ä¸€ä¸ªç”¨æœ¬åœ°æ—¶åŒºè§£é‡Šçš„å­—ç¬¦ä¸²

`toUTCString` æ–¹æ³•è¿”å›ä¸€ä¸ªä»¥ [RFC 7231](https://datatracker.ietf.org/doc/html/rfc7231#section-7.1.1.1) æ ¼å¼çš„å­—ç¬¦ä¸²

```js
const date = new Date("2023-05-15T23:10:00.100");

console.log(date.toString());    // Mon May 15 2023 23:10:00 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)
console.log(date1.toUTCString()); // 30 Mon, 15 May 2023 15:10:00 GMT
```

## æ—¶é—´æˆ³

**Date** å…¶å®å°±æ˜¯å°è£…äº†ä¸€ä¸ªæ•´æ•°çš„å¯¹è±¡ï¼Œè¿™ä¸ªæ•´æ•°è¡¨ç¤ºä» UTC 1970-01-01 00:00:00 å¼€å§‹çš„æ¯«ç§’æ•°ã€‚å¯ä»¥é€šè¿‡ `getTime` æˆ–è€… `Date.now` è·å–è¿™ä¸ªæ—¶é—´æˆ³ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ `setTime` è®¾ç½®æ—¶é—´æˆ³ã€‚

```js
const date = new Date("2023-05-15T10:10:10.100Z");
date.getTime(); // 1684145410100 
// ç­‰ä»·äº new Date().getTime()
Date.now();
// 2023-05-16T10:10:10.100Z
date.setTime(date.getTime() + 24 * 3600 * 1000) 
```

å½“ date æ— æ•ˆæ—¶ï¼Œ`getTime` è¿”å› `NaN`ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼åˆ¤æ–­ date æ˜¯å¦æœ‰æ•ˆã€‚

```js
const isValidDate = (date) => {
  if (date instanceof Date) {
    return !isNaN(date);
  }
  if (typeof date === "string" || typeof date === "number") {
    const dateInstance = new Date(date);
    return !isNaN(dateInstance);
  }
  return false;
};
```

`valueOf` æ–¹æ³•ç­‰ä»·äº `getTime`ï¼Œè¿”å›æ—¶é—´æˆ³ã€‚æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªå¯¹è±¡åœ¨è½¬æ¢æˆ `number` æ—¶ï¼Œä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„ `valueOf` æ–¹æ³•ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°æ¯”è¾ƒä¸¤ä¸ª dateã€‚

```js
const date1 = new Date("2023-05-15T10:10:10");
const date2 = new Date("2023-05-16T10:10:10");

date2 > date1; // true
date2 >= date1; // true
date1 < date2; // true
date1 <= date2; // true
```

 æ³¨æ„æ¯”è¾ƒç›¸ç­‰ä¸èƒ½ä½¿ç”¨ ==/!=ï¼Œå› ä¸ºè¿™æ˜¯åœ¨æ¯”è¾ƒä¸¤ä¸ª date å¯¹è±¡æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼Œè€Œåº”è¯¥è¿™æ ·

```js
const date1 = new Date("2023-05-15T10:10:10");
const date2 = new Date("2023-05-15T10:10:10");
date1 - date2 === 0; // ture
date1.getTime() === date2.getTime(); // true
date1.valueOf() === date2.valueOf(); // true
```

æ³¨æ„æ¯”è¾ƒä¸¤ä¸ª date æ—¶ï¼Œæ—¶åŒºè¦ä¸€è‡´

```js
// æ³¨æ„æ¯”è¾ƒä¸¤ä¸ª date æ—¶ï¼Œæ—¶åŒºè¦ä¸€è‡´
const date1 = new Date("2023-05-15");              // UTC æ—¶é—´
const date2 = new Date("2023-05-15T00:00:00.000"); // æœ¬åœ°æ—¶é—´
date1 - date2 === 0; // false
```

## å¸¸ç”¨æ“ä½œ

å¸¸ç”¨çš„æ“ä½œæœ‰è®¡ç®—å¤šå°‘å¤©åçš„æ—¥æœŸï¼Œå¤šå°‘å¤©å‰çš„æ—¥æœŸï¼Œè¿‡å»äº†å¤šé•¿æ—¶é—´ç­‰ç­‰

#### å¤šå°‘å¤©å

```js
// æ–¹æ³•ä¸€ï¼šé€šè¿‡ `setTime` è®¾ç½®æ—¶é—´æˆ³
export const after = (days, date) => {
  if (!isValidDate(date)) {
    return new Date();
  }
  return new Date(date.getTime() + days * 24 * 60 * 60 * 1000);
};

// æ–¹æ³•äºŒï¼šé€šè¿‡ `setDate` è®¾ç½® days
export const after2 = (days, date) => {
  if (!isValidDate(date)) {
    return new Date();
  }
  const newDate = new Date(date);
  newDate.setDate(newDate.getDate() + days);
  return newDate;
};
```

#### å¤šå°‘å¤©å‰

```js
// æ–¹æ³•ä¸€ï¼šé€šè¿‡ `setTime` è®¾ç½®æ—¶é—´æˆ³
export const before = (days, date) => {
  if (!isValidDate(date)) {
    return new Date();
  }
  return new Date(date.getTime() - days * 24 * 60 * 60 * 1000);
};

// æ–¹æ³•äºŒï¼šé€šè¿‡ `setDate` è®¾ç½® days
export const before2 = (days, date) => {
  if (!isValidDate(date)) {
    return new Date();
  }
  const newDate = new Date(date);
  newDate.setDate(newDate.getDate() - days);
  return newDate;
};
```

#### è®¡ç®—è¿‡å»äº†å¤šé•¿æ—¶é—´

ä¸€ä¸ªç²—ç•¥çš„è®¡ç®—æ–¹æ³•å¦‚ä¸‹

```js
export const timeElapsed = (date, now = new Date()) => {
  if (!isValidDate(date) || date - now > 0) {
    return "";
  }
  
  const diff = now - date;
  const seconds = diff / 1000;
  if (seconds < 1) {
    return "åˆšåˆš";
  }
  if (seconds < 60) {
    return `${Math.floor(seconds)}ç§’å‰`;
  }
  const minutes = seconds / 60;
  if (minutes < 60) {
    return `${Math.floor(minutes)}åˆ†é’Ÿå‰`;
  }
  const hours = minutes / 60;
  if (hours < 24) {
    return `${Math.floor(hours)}å°æ—¶å‰`;
  }
  const days = hours / 24;
  if (days <= 30) {
    return `${Math.floor(days)}å¤©å‰`;
  }
  const years = days / 365;
  if (years >= 1) {
    return `${Math.floor(years)}å¹´å‰`;
  }
  const months = days / 30;
  return `${Math.floor(months)}ä¸ªæœˆå‰`;
};
```

ä¸ºä»€ä¹ˆè¯´å®ƒæ˜¯ä¸ªç²—ç•¥çš„è®¡ç®—æ–¹æ³•å‘¢ï¼Ÿå› ä¸ºé—°å¹´æœ‰ 366 å¤©ï¼Œä¸€ä¸ªæœˆä¸éƒ½æ˜¯ 30 å¤©ã€‚æ¯”å¦‚ "2022-03-17" ç›¸å¯¹äº "2022-09-15" æ˜¯ 5 ä¸ªå¤šæœˆå‰ï¼Œè€Œ `timeElapsed` è¿”å› "6ä¸ªæœˆå‰"

```js
timeElapsed("2022-03-17T00:00:00", "2022-09-15T00:00:00") // 6ä¸ªæœˆå‰
```

ä¸€ä¸ªä¿®è®¢åçš„ç‰ˆæœ¬è¯·çœ‹ [Demo](https://gitee.com/cp3hnu/web-demo/tree/master/date-demo)ï¼ˆä»£ç æ¯”è¾ƒé•¿å°±ä¸è´´ä¸Šæ¥äº†ï¼‰ã€‚

## References

- [Date](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date)
- [Date Time String Format](https://tc39.es/ecma262/multipage/numbers-and-dates.html#sec-date-time-string-format)
- [Time.is](https://time.is/UTC)
- [RFC-2822](https://datatracker.ietf.org/doc/html/rfc2822#section-3.3)
-  [RFC 7231](https://datatracker.ietf.org/doc/html/rfc7231#section-7.1.1.1)
-  [Intl.DateTimeFormat](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat)
-  [BCP-47](https://www.rfc-editor.org/rfc/rfc5646)
-  [å¸¸ç”¨çš„ locales](https://gist.github.com/msikma/8912e62ed866778ff8cd#file-rfc5646-language-tags-js)
-  [List of tz database time zones](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones)

## Demo

[date-demo](https://gitee.com/cp3hnu/web-demo/tree/master/date-demo)
