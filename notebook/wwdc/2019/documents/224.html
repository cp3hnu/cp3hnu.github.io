<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>224-Modernizing Your UI for iOS 13 | Study &amp; Product</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <meta name="description" content="
Flexible UI

Launch Storyboards

App Store 现在要求 App 必须包含 launch storyboard 文件

Bars

新增 UINavigationBarAppearance 类，配置 NavigationBar 的外观

class UINavigationBarAppearance : UIBar ...">
    <meta name="algolia-site-verification" content="23333450F18E92C1">
    
    <link rel="preload" href="/assets/css/0.styles.cd1f7b12.css" as="style"><link rel="preload" href="/assets/js/app.b07256e7.js" as="script"><link rel="preload" href="/assets/js/34.49b71b2c.js" as="script"><link rel="preload" href="/assets/js/5.373c53f3.js" as="script"><link rel="preload" href="/assets/js/73.c3dcfd4b.js" as="script"><link rel="prefetch" href="/assets/js/10.7c5bc6fc.js"><link rel="prefetch" href="/assets/js/100.f675d046.js"><link rel="prefetch" href="/assets/js/101.92ede1ec.js"><link rel="prefetch" href="/assets/js/102.678a907d.js"><link rel="prefetch" href="/assets/js/103.959ad108.js"><link rel="prefetch" href="/assets/js/104.b15677eb.js"><link rel="prefetch" href="/assets/js/105.377da8a5.js"><link rel="prefetch" href="/assets/js/106.29a8c44d.js"><link rel="prefetch" href="/assets/js/107.64b19904.js"><link rel="prefetch" href="/assets/js/108.a3e75a67.js"><link rel="prefetch" href="/assets/js/109.283d92d8.js"><link rel="prefetch" href="/assets/js/11.e6a0311f.js"><link rel="prefetch" href="/assets/js/110.cbb6ea81.js"><link rel="prefetch" href="/assets/js/111.252f143f.js"><link rel="prefetch" href="/assets/js/112.df62c9fe.js"><link rel="prefetch" href="/assets/js/113.66189350.js"><link rel="prefetch" href="/assets/js/114.890cd7de.js"><link rel="prefetch" href="/assets/js/115.53823707.js"><link rel="prefetch" href="/assets/js/116.caaa6eaa.js"><link rel="prefetch" href="/assets/js/117.b7b0f88f.js"><link rel="prefetch" href="/assets/js/118.03168974.js"><link rel="prefetch" href="/assets/js/119.90f4d7b7.js"><link rel="prefetch" href="/assets/js/12.8da07182.js"><link rel="prefetch" href="/assets/js/120.b654e5ee.js"><link rel="prefetch" href="/assets/js/121.92d87086.js"><link rel="prefetch" href="/assets/js/13.a9f90626.js"><link rel="prefetch" href="/assets/js/14.b18d5210.js"><link rel="prefetch" href="/assets/js/15.835c7671.js"><link rel="prefetch" href="/assets/js/16.eb29ed80.js"><link rel="prefetch" href="/assets/js/17.c4871518.js"><link rel="prefetch" href="/assets/js/18.606b879c.js"><link rel="prefetch" href="/assets/js/19.777086a8.js"><link rel="prefetch" href="/assets/js/20.c8e69fcc.js"><link rel="prefetch" href="/assets/js/21.6cda2658.js"><link rel="prefetch" href="/assets/js/22.19e356e1.js"><link rel="prefetch" href="/assets/js/23.ca8661ea.js"><link rel="prefetch" href="/assets/js/24.9f090eaf.js"><link rel="prefetch" href="/assets/js/25.be2c8a0c.js"><link rel="prefetch" href="/assets/js/26.5ce52eaa.js"><link rel="prefetch" href="/assets/js/27.d75e1151.js"><link rel="prefetch" href="/assets/js/28.6863d7e4.js"><link rel="prefetch" href="/assets/js/29.d8a1c4f2.js"><link rel="prefetch" href="/assets/js/3.276926dd.js"><link rel="prefetch" href="/assets/js/30.178b8dc0.js"><link rel="prefetch" href="/assets/js/31.4c488d0e.js"><link rel="prefetch" href="/assets/js/32.ce3ae3c7.js"><link rel="prefetch" href="/assets/js/33.828dd0d1.js"><link rel="prefetch" href="/assets/js/35.9496ed4c.js"><link rel="prefetch" href="/assets/js/36.33ada8e1.js"><link rel="prefetch" href="/assets/js/37.e9705ffe.js"><link rel="prefetch" href="/assets/js/38.f9c57096.js"><link rel="prefetch" href="/assets/js/39.75b77f83.js"><link rel="prefetch" href="/assets/js/4.c651aa9d.js"><link rel="prefetch" href="/assets/js/40.4496a5db.js"><link rel="prefetch" href="/assets/js/41.260393e3.js"><link rel="prefetch" href="/assets/js/42.083f9350.js"><link rel="prefetch" href="/assets/js/43.8d311a8e.js"><link rel="prefetch" href="/assets/js/44.df55763b.js"><link rel="prefetch" href="/assets/js/45.e19037c7.js"><link rel="prefetch" href="/assets/js/46.9529f37b.js"><link rel="prefetch" href="/assets/js/47.8d631e39.js"><link rel="prefetch" href="/assets/js/48.3acad59c.js"><link rel="prefetch" href="/assets/js/49.9a12a900.js"><link rel="prefetch" href="/assets/js/50.f30877b8.js"><link rel="prefetch" href="/assets/js/51.e8b2adf9.js"><link rel="prefetch" href="/assets/js/52.e6a458bb.js"><link rel="prefetch" href="/assets/js/53.e4027d0c.js"><link rel="prefetch" href="/assets/js/54.5a4be38d.js"><link rel="prefetch" href="/assets/js/55.924ee4f8.js"><link rel="prefetch" href="/assets/js/56.11ff1ccf.js"><link rel="prefetch" href="/assets/js/57.14327960.js"><link rel="prefetch" href="/assets/js/58.cea182b0.js"><link rel="prefetch" href="/assets/js/59.2db874c7.js"><link rel="prefetch" href="/assets/js/6.6878fac4.js"><link rel="prefetch" href="/assets/js/60.e3e4017b.js"><link rel="prefetch" href="/assets/js/61.d5cd385e.js"><link rel="prefetch" href="/assets/js/62.6929f93f.js"><link rel="prefetch" href="/assets/js/63.3f8bf719.js"><link rel="prefetch" href="/assets/js/64.e89e1572.js"><link rel="prefetch" href="/assets/js/65.a4335c65.js"><link rel="prefetch" href="/assets/js/66.cc9fb484.js"><link rel="prefetch" href="/assets/js/67.d5da8f2f.js"><link rel="prefetch" href="/assets/js/68.91a38f6d.js"><link rel="prefetch" href="/assets/js/69.800ca600.js"><link rel="prefetch" href="/assets/js/7.6f2558ea.js"><link rel="prefetch" href="/assets/js/70.f7b16ee7.js"><link rel="prefetch" href="/assets/js/71.e34929dc.js"><link rel="prefetch" href="/assets/js/72.175a64bf.js"><link rel="prefetch" href="/assets/js/74.65978082.js"><link rel="prefetch" href="/assets/js/75.718d5152.js"><link rel="prefetch" href="/assets/js/76.2ed620b3.js"><link rel="prefetch" href="/assets/js/77.f8726387.js"><link rel="prefetch" href="/assets/js/78.1dea2e59.js"><link rel="prefetch" href="/assets/js/79.f62213a1.js"><link rel="prefetch" href="/assets/js/8.81ebcef8.js"><link rel="prefetch" href="/assets/js/80.7600ac29.js"><link rel="prefetch" href="/assets/js/81.ab94746f.js"><link rel="prefetch" href="/assets/js/82.26baf7f8.js"><link rel="prefetch" href="/assets/js/83.89a3942a.js"><link rel="prefetch" href="/assets/js/84.1a5577ac.js"><link rel="prefetch" href="/assets/js/85.eb62de22.js"><link rel="prefetch" href="/assets/js/86.7635121c.js"><link rel="prefetch" href="/assets/js/87.5bee4d72.js"><link rel="prefetch" href="/assets/js/88.04d56860.js"><link rel="prefetch" href="/assets/js/89.09a7d920.js"><link rel="prefetch" href="/assets/js/9.7f69b9b1.js"><link rel="prefetch" href="/assets/js/90.dac6a66e.js"><link rel="prefetch" href="/assets/js/91.14f101dd.js"><link rel="prefetch" href="/assets/js/92.d398eb09.js"><link rel="prefetch" href="/assets/js/93.7a5477fa.js"><link rel="prefetch" href="/assets/js/94.c4bf7674.js"><link rel="prefetch" href="/assets/js/95.a0c3c94c.js"><link rel="prefetch" href="/assets/js/96.c3a44db5.js"><link rel="prefetch" href="/assets/js/97.6956ed39.js"><link rel="prefetch" href="/assets/js/98.ad65fe08.js"><link rel="prefetch" href="/assets/js/99.4fe76e2f.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.cb5d1302.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cd1f7b12.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">Study &amp; Product </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Home</a></li><li class="nav-item"><a href="/blog/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/notebook/" class="nav-link router-link-active">Notebook</a></li><li class="nav-item"><a href="/about/" class="nav-link">About</a></li><li class="nav-item"><a href="https://github.com/cp3hnu" target="_blank" rel="noopener noreferrer" class="nav-link external">GitHub</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">Study &amp; Product </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Home</a></li><li class="mobile-nav-item"><a href="/blog/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/notebook/" class="nav-link router-link-active">Notebook</a></li><li class="mobile-nav-item"><a href="/about/" class="nav-link">About</a></li><li class="mobile-nav-item"><a href="https://github.com/cp3hnu" target="_blank" rel="noopener noreferrer" class="nav-link external">GitHub</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper index-page"><div id="vuepress-theme-blog__post-layout"><aside class="sidebar"> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/notebook/wwdc/" class="sidebar-heading clickable router-link-active open"><span>WWDC</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>2017</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>2019</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notebook/wwdc/2019/documents/206.html" class="sidebar-link">206-Introducing SF Symbols</a></li><li><a href="/notebook/wwdc/2019/documents/212.html" class="sidebar-link">212-Introducing Multiple Windows on iPad</a></li><li><a href="/notebook/wwdc/2019/documents/214.html" class="sidebar-link">214-Implementing Dark Mode on iOS</a></li><li><a href="/notebook/wwdc/2019/documents/215.html" class="sidebar-link">215-Advances in Collection View Layout</a></li><li><a href="/notebook/wwdc/2019/documents/220.html" class="sidebar-link">220-Advances in UI Data Sources</a></li><li><a href="/notebook/wwdc/2019/documents/224.html" aria-current="page" class="active sidebar-link">224-Modernizing Your UI for iOS 13</a></li><li><a href="/notebook/wwdc/2019/documents/227.html" class="sidebar-link">227-Font Management and Text Scaling</a></li><li><a href="/notebook/wwdc/2019/documents/234.html" class="sidebar-link">234-Text Recognition in Vision Framework</a></li><li><a href="/notebook/wwdc/2019/documents/235.html" class="sidebar-link">235-Taking iPad Apps for Mac to the Next Level</a></li><li><a href="/notebook/wwdc/2019/documents/246.html" class="sidebar-link">246-Window Management in Your Multitasking App</a></li><li><a href="/notebook/wwdc/2019/documents/256.html" class="sidebar-link">256-Advances in Speech Recognition</a></li><li><a href="/notebook/wwdc/2019/documents/258.html" class="sidebar-link">258-Architecting Your App for Multiple Windows</a></li><li><a href="/notebook/wwdc/2019/documents/259.html" class="sidebar-link">259-Targeting Content with Multiple Windows</a></li><li><a href="/notebook/wwdc/2019/documents/401.html" class="sidebar-link">401-What's New in Xcode</a></li><li><a href="/notebook/wwdc/2019/documents/402.html" class="sidebar-link">402-What's New in Swift</a></li><li><a href="/notebook/wwdc/2019/documents/403.html" class="sidebar-link">403-Creating Great Localized Experiences with Xcode 11</a></li><li><a href="/notebook/wwdc/2019/documents/408.html" class="sidebar-link">408-Adopting Swift Packages in Xcode</a></li><li><a href="/notebook/wwdc/2019/documents/410.html" class="sidebar-link">410-Creating Swift Packages</a></li><li><a href="/notebook/wwdc/2019/documents/413.html" class="sidebar-link">413-Testing in Xcode</a></li><li><a href="/notebook/wwdc/2019/documents/416.html" class="sidebar-link">416-Binary Frameworks in Swift</a></li><li><a href="/notebook/wwdc/2019/documents/511.html" class="sidebar-link">511-Supporting Dark Mode in Your Web Content</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>2020</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li></ul> </aside> <a href="/notebook/wwdc/" class="back-to-list"><img src="/assets/img/back.png" width="20"> 返回列表
  </a> <article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-sidebar-content"><div itemprop="articleBody" class="content__default"><h1 id="_224-modernizing-your-ui-for-ios-13"><a href="#_224-modernizing-your-ui-for-ios-13" class="header-anchor">#</a> 224-Modernizing Your UI for iOS 13</h1> <h2 id="flexible-ui"><a href="#flexible-ui" class="header-anchor">#</a> Flexible UI</h2> <h3 id="launch-storyboards"><a href="#launch-storyboards" class="header-anchor">#</a> Launch Storyboards</h3> <p>App Store 现在要求 App 必须包含 launch storyboard 文件</p> <h2 id="bars"><a href="#bars" class="header-anchor">#</a> Bars</h2> <p>新增 <em>UINavigationBarAppearance</em> 类，配置 NavigationBar 的外观</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">UINavigationBarAppearance</span> <span class="token punctuation">:</span> <span class="token builtin">UIBarAppearance</span> <span class="token punctuation">{</span>
  <span class="token comment">/// String attributes to apply to the text of a standard-size title.</span>
  <span class="token keyword">var</span> titleTextAttributes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">NSAttributedString</span><span class="token punctuation">.</span><span class="token builtin">Key</span> <span class="token punctuation">:</span> <span class="token builtin">Any</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
  
  <span class="token comment">/// String attributes to apply to the text of a large-size title.</span>
  <span class="token keyword">var</span> largeTitleTextAttributes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">NSAttributedString</span><span class="token punctuation">.</span><span class="token builtin">Key</span> <span class="token punctuation">:</span> <span class="token builtin">Any</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
  
  <span class="token comment">/// The distance, in points, by which to offset the title horizontally and vertically.</span>
  <span class="token keyword">var</span> titlePositionAdjustment<span class="token punctuation">:</span> <span class="token builtin">UIOffset</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
  
  <span class="token comment">/// Sets the back button indicator image and its transition mask.</span>
  <span class="token keyword">func</span> <span class="token function">setBackIndicatorImage</span><span class="token punctuation">(</span><span class="token number">_</span> backIndicatorImage<span class="token punctuation">:</span> <span class="token builtin">UIImage</span><span class="token operator">?</span><span class="token punctuation">,</span> transitionMaskImage backIndicatorTransitionMaskImage<span class="token punctuation">:</span> <span class="token builtin">UIImage</span><span class="token operator">?</span><span class="token punctuation">)</span>
  
   <span class="token comment">/// The image to display on the leading edge of the back button.</span>
  <span class="token keyword">var</span> backIndicatorImage<span class="token punctuation">:</span> <span class="token builtin">UIImage</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
  
  <span class="token comment">/// The image for masking content flowing under the back indicator image during push and pop transitions.</span>
  <span class="token keyword">var</span> backIndicatorTransitionMaskImage<span class="token punctuation">:</span> <span class="token builtin">UIImage</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
  
  <span class="token comment">/// The appearance attributes for bar button items in the navigation bar.</span>
  <span class="token keyword">var</span> buttonAppearance<span class="token punctuation">:</span> <span class="token builtin">UIBarButtonItemAppearance</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
  <span class="token keyword">var</span> backButtonAppearance<span class="token punctuation">:</span> <span class="token builtin">UIBarButtonItemAppearance</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
  <span class="token keyword">var</span> doneButtonAppearance<span class="token punctuation">:</span> <span class="token builtin">UIBarButtonItemAppearance</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><em>UINavigationBar</em> 和 <em>UINavigationItem</em> 新增 appearance 属性</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">UINavigationBar</span> <span class="token punctuation">{</span>
  <span class="token comment">/// The appearance settings for a standard-height navigation bar.</span>
  <span class="token keyword">var</span> standardAppearance<span class="token punctuation">:</span> <span class="token builtin">UINavigationBarAppearance</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
  
  <span class="token comment">/// The appearance settings for a compact-height navigation bar. </span>
  <span class="token comment">/// 除 plus、XR(11)、XS Max(11 Pro Max) 之外横屏 iPhone</span>
  <span class="token keyword">var</span> compactAppearance<span class="token punctuation">:</span> <span class="token builtin">UINavigationBarAppearance</span><span class="token operator">?</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
  
  <span class="token comment">/// The appearance settings to use when the edge of any scrollable content reaches the matching edge of the navigation bar.</span>
  <span class="token comment">/// If the value of this property is nil, UIKit uses a modified version of the settings found in the standardAppearance property.</span>
  <span class="token keyword">var</span> scrollEdgeAppearance<span class="token punctuation">:</span> <span class="token builtin">UINavigationBarAppearance</span><span class="token operator">?</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>此外还新增下面这些类，分别对应相应的控件</p> <p><em>UIBarAppearance</em></p> <p><em>UITabBarAppearance</em></p> <p><em>UIToolbarAppearance</em></p> <p><em>UITabBarItemAppearance</em></p> <p><em>UIBarButtonItemAppearance</em></p> <p><em>UITabBarItemStateAppearance</em></p> <p><em>UIBarButtonItemStateAppearance</em></p> <h3 id="new"><a href="#new" class="header-anchor">#</a> New</h3> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">let</span> appearance <span class="token operator">=</span> <span class="token function">UINavigationBarAppearance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
appearance<span class="token punctuation">.</span><span class="token function">configureWithOpaqueBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
appearance<span class="token punctuation">.</span>titleTextAttributes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>foregroundColor<span class="token punctuation">:</span> myAppLabelColor<span class="token punctuation">]</span>
appearance<span class="token punctuation">.</span>largeTitleTextAttributes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>foregroundColor<span class="token punctuation">:</span> myAppLabelColor<span class="token punctuation">]</span>
 
navigationBar<span class="token punctuation">.</span>standardAppearance <span class="token operator">=</span> appearance
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="deprecated"><a href="#deprecated" class="header-anchor">#</a> Deprecated</h3> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token comment">// UINavigationBar</span>
<span class="token builtin">UINavigationBar</span><span class="token punctuation">.</span><span class="token function">appearance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>titleTextAttributes <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token builtin">UINavigationBar</span><span class="token punctuation">.</span><span class="token function">appearance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tintColor <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        
<span class="token keyword">let</span> backImage <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token builtin">UINavigationBar</span><span class="token punctuation">.</span><span class="token function">appearance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>backIndicatorImage <span class="token operator">=</span> backImage
<span class="token builtin">UINavigationBar</span><span class="token punctuation">.</span><span class="token function">appearance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>backIndicatorTransitionMaskImage <span class="token operator">=</span> backImage
        
<span class="token comment">// UIBarButtonItem</span>
<span class="token keyword">let</span> navbarItemTA <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token builtin">UIBarButtonItem</span><span class="token punctuation">.</span><span class="token function">appearance</span><span class="token punctuation">(</span>whenContainedInInstancesOf<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">UINavigationBar</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setTitleTextAttributes</span><span class="token punctuation">(</span>navbarItemTA<span class="token punctuation">,</span> <span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>normal<span class="token punctuation">)</span>

<span class="token builtin">UIBarButtonItem</span><span class="token punctuation">.</span><span class="token function">appearance</span><span class="token punctuation">(</span>whenContainedInInstancesOf<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">UINavigationBar</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setTitleTextAttributes</span><span class="token punctuation">(</span>navbarItemTA<span class="token punctuation">,</span> <span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>highlighted<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="presentations"><a href="#presentations" class="header-anchor">#</a> Presentations</h2> <h3 id="重新设计uimodalpresentationstyle的-pagesheet-和-formsheet"><a href="#重新设计uimodalpresentationstyle的-pagesheet-和-formsheet" class="header-anchor">#</a> 重新设计UIModalPresentationStyle的 .pageSheet 和 .formSheet</h3> <p>.pagesheet 展示的页面比 .formSheet 大</p> <p>在 regular height（例如：iPhone 竖屏），没有铺面全屏，有点像 stack，并且 presenting view controller 可见，iOS 13 以前效果等同于 .fullScreen。</p> <p>在 compact height（例如： iPhone 横屏），等价于 .fullScreen。</p> <p>在 iPad 中，居中，有点像 stack，其 size 可变（dynamic type size 改变 readable width 继而改变 view size），下面的 presenting view controller 可见。</p> <p>.popover 也有变化，在 compact width,  效果等同于 Sheet。</p> <h3 id="新增并默认-automatic"><a href="#新增并默认-automatic" class="header-anchor">#</a> 新增并默认 .automatic</h3> <p>.automatic 的行为因 view controller 而已，系统的相册选择 view controller 是 .pageSheet，而系统的拍照 view controller 是.fullScreen，自定义的 view controller是 .pageSheet。</p> <h3 id="pagesheet-和-formsheet-禁止手势-dismiss"><a href="#pagesheet-和-formsheet-禁止手势-dismiss" class="header-anchor">#</a> .pageSheet 和 .formSheet 禁止手势 dismiss</h3> <p><img src="/assets/img/224-1.3d102f47.png" alt=""></p> <p>新增属性和方法</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span>
  <span class="token comment">/// 设置 true, 阻止dismiss</span>
  <span class="token keyword">var</span> isModalInPresentation<span class="token punctuation">:</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">protocol</span> <span class="token builtin">UIAdaptivePresentationControllerDelegate</span> <span class="token punctuation">{</span>
  <span class="token comment">/// 当isModalInPresentation == true, 试图dismiss时，是会调用这个方法</span>
  <span class="token comment">/// 可以在这个方法里 present sheet action</span>
  <span class="token keyword">func</span> <span class="token function">presentationControllerDidAttemptToDismiss</span><span class="token punctuation">(</span><span class="token number">_</span> presentationController<span class="token punctuation">:</span> <span class="token builtin">UIPresentationController</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>将实现了 <em>UIAdaptivePresentationControllerDelegate</em> 协议的对象赋值给 <em>UIPresentingController</em> 的 <code>delete</code> 属性</p> <h4 id="demo"><a href="#demo" class="header-anchor">#</a> Demo</h4> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token comment">// In present action of a view controller</span>
<span class="token keyword">func</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> controller <span class="token operator">=</span> <span class="token function">CustomViewController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  controller<span class="token punctuation">.</span>presentationController<span class="token operator">?</span><span class="token punctuation">.</span>delegate <span class="token operator">=</span> controller
  <span class="token function">present</span><span class="token punctuation">(</span>controller<span class="token punctuation">,</span> animated<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">CustomViewController</span><span class="token punctuation">:</span> <span class="token builtin">UIAdaptivePresentationControllerDelegate</span> <span class="token punctuation">{</span>
  <span class="token keyword">func</span> <span class="token function">presentationControllerDidAttemptToDismiss</span><span class="token punctuation">(</span><span class="token number">_</span> presentationController<span class="token punctuation">:</span> <span class="token builtin">UIPresentationController</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// present sheet action</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="search"><a href="#search" class="header-anchor">#</a> Search</h2> <h3 id="新增属性"><a href="#新增属性" class="header-anchor">#</a> 新增属性</h3> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">UISearchController</span> <span class="token punctuation">{</span>
  <span class="token comment">/// 是否自动显示/隐藏 cancel button, 默认是 true </span>
  <span class="token comment">/// 设置 searchBar 的 showsCancelButton 属性将导致 automaticallyShowsCancelButton 设为 false</span>
  <span class="token keyword">var</span> automaticallyShowsCancelButton<span class="token punctuation">:</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
  
  <span class="token comment">/// 是否自动显示/隐藏 scope bar, 默认是 true </span>
  <span class="token comment">/// 设置 searchBar 的 showsScopeBar 属性将导致 automaticallyShowsScopeBar 设为 false</span>
  <span class="token keyword">var</span> automaticallyShowsScopeBar<span class="token punctuation">:</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
  
  <span class="token comment">/// 是否自动显示/隐藏搜索结果, 默认是 true </span>
  <span class="token comment">/// 设置 showsSearchResultsController 将导致 automaticallyShowsSearchResultsController 设为 false</span>
  <span class="token keyword">var</span> automaticallyShowsSearchResultsController<span class="token punctuation">:</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
  
  <span class="token comment">/// true, 当 search activated, 立刻显现搜索结果</span>
  <span class="token keyword">var</span> showsSearchResultsController<span class="token punctuation">:</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">UISearchBar</span> <span class="token punctuation">{</span>
  <span class="token comment">/// 终于等到它</span>
  <span class="token keyword">var</span> searchTextField<span class="token punctuation">:</span> <span class="token builtin">UISearchTextField</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="search-token"><a href="#search-token" class="header-anchor">#</a> Search token</h3> <p><em>UISearchToken</em> 用于 <em>UISearchTextField</em> 中，带有图片和文字，作为一个整体能被选中和删除，以及支持 copy/paste  和 drag/drop</p> <h4 id="create-search-token"><a href="#create-search-token" class="header-anchor">#</a> Create search token</h4> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">let</span> selectedText <span class="token operator">=</span> field<span class="token punctuation">.</span><span class="token function">textIn</span><span class="token punctuation">(</span>filed<span class="token punctuation">.</span>selectedTextRange<span class="token punctuation">)</span>
<span class="token keyword">let</span> token <span class="token operator">=</span> <span class="token function">UISearchToken</span><span class="token punctuation">(</span>icon<span class="token punctuation">:</span> <span class="token constant">nil</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> selectedText<span class="token punctuation">)</span>
field<span class="token punctuation">.</span><span class="token function">replaceTextualPortion</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> field<span class="token punctuation">.</span>selectedTextRange<span class="token punctuation">,</span> with<span class="token punctuation">:</span> token<span class="token punctuation">,</span> at<span class="token punctuation">:</span> field<span class="token punctuation">.</span>tokens<span class="token punctuation">.</span><span class="token builtin">count</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="textualrange-in-uisearchtextfield"><a href="#textualrange-in-uisearchtextfield" class="header-anchor">#</a> textualRange (in UISearchTextField)</h3> <p>The beginning of the textualRange is the first nontoken character in the field, and its end is the end of the document.</p> <h2 id="gestures"><a href="#gestures" class="header-anchor">#</a> Gestures</h2> <h3 id="selection-gestures-in-custom-text-views"><a href="#selection-gestures-in-custom-text-views" class="header-anchor">#</a> Selection gestures in custom text views</h3> <p>UITextInteraction, 提供 text selection gestures and UI for custom text views（像 UITextView, UITextField一样）.</p> <p>三行代码</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token comment">// Create a selection interaction for non-editable content.</span>
<span class="token keyword">let</span> selectionInteraction <span class="token operator">=</span> <span class="token function">UITextInteraction</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>nonEditable<span class="token punctuation">)</span>

<span class="token comment">// Assign `textInput` to your view that implements the `UITextInput` protocol</span>
<span class="token comment">// to get more control over the selection behavior and the text input system.</span>
selectionInteraction<span class="token punctuation">.</span>textInput <span class="token operator">=</span> customTextView

<span class="token comment">// Add the interaction to the view.</span>
customTextView<span class="token punctuation">.</span><span class="token function">addInteraction</span><span class="token punctuation">(</span>selectionInteraction<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="multiple-selection-gestures-in-tables-and-collections"><a href="#multiple-selection-gestures-in-tables-and-collections" class="header-anchor">#</a> Multiple selection gestures in tables and collections</h3> <p>两根手指滑动，可以将列表置为编辑模式，同时两根手指可以滑动选中多个。</p> <p>带键盘的时候，按住 Shift 键或者 Command 键, 可以多选。</p> <h4 id="新增-delegate-方法-collection-view-也有类似的代理方法"><a href="#新增-delegate-方法-collection-view-也有类似的代理方法" class="header-anchor">#</a> 新增 delegate 方法，collection view 也有类似的代理方法</h4> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token builtin">UIViewController</span><span class="token punctuation">,</span> <span class="token builtin">UITableViewDelegate</span> <span class="token punctuation">{</span>
  <span class="token comment">/// 是否允许某一行可以多选 </span>
  <span class="token keyword">func</span> <span class="token function">tableView</span><span class="token punctuation">(</span><span class="token number">_</span> tableView<span class="token punctuation">:</span> <span class="token builtin">UITableView</span><span class="token punctuation">,</span> shouldBeginMultipleSelectionInteractionAt indexPath<span class="token punctuation">:</span> <span class="token builtin">IndexPath</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">/// Tells the delegate when the user starts using a two-finger pan gesture to select multiple rows in a table view.</span>
  <span class="token keyword">func</span> <span class="token function">tableView</span><span class="token punctuation">(</span><span class="token number">_</span> tableView<span class="token punctuation">:</span> <span class="token builtin">UITableView</span><span class="token punctuation">,</span> didBeginMultipleSelectionInteractionAt indexPath<span class="token punctuation">:</span> <span class="token builtin">IndexPath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Replace the Edit button with Done, and put the</span>
    <span class="token comment">// table view into editing mode.</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">setEditing</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> animated<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">/// Tells the delegate when the user stops using a two-finger pan gesture to select multiple rows in a table view</span>
  <span class="token keyword">func</span> <span class="token function">tableViewDidEndMultipleSelectionInteraction</span><span class="token punctuation">(</span><span class="token number">_</span> tableView<span class="token punctuation">:</span> <span class="token builtin">UITableView</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="editing-gestures"><a href="#editing-gestures" class="header-anchor">#</a> Editing gestures</h3> <ol><li>Using three fingers, users can now swipe to undo or redo. (需要使用 undo manager?)</li> <li>Pinching three fingers in will copy, and then pinching them out will paste.</li></ol> <p>可以禁止 editing 手势, 自定义 view, 然后 override <code>editingInteractionConfiguration = .none</code></p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">protocol</span> <span class="token builtin">UIResponder</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> editingInteractionConfiguration<span class="token punctuation">:</span> <span class="token builtin">UIEditingInteractionConfiguration</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token builtin">UIEditingInteractionConfiguration</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> `<span class="token keyword">default</span>` <span class="token comment">// 默认</span>
  <span class="token keyword">case</span> <span class="token keyword">none</span>      <span class="token comment">// 禁止</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="menus"><a href="#menus" class="header-anchor">#</a> Menus</h2> <p>展示菜单，新增类和协议</p> <h4 id="uicontextmenuinteraction-类"><a href="#uicontextmenuinteraction-类" class="header-anchor">#</a> UIContextMenuInteraction 类</h4> <p>An interaction object that you use to display relevant actions for your content.</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">let</span> interaction <span class="token operator">=</span> <span class="token function">UIContextMenuInteraction</span><span class="token punctuation">(</span>delegate<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">)</span>
<span class="token comment">// Attach It to Our View</span>
<span class="token keyword">self</span><span class="token punctuation">.</span>view<span class="token punctuation">.</span><span class="token function">addInteraction</span><span class="token punctuation">(</span>interaction<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="uicontextmenuinteractiondelegate-协议"><a href="#uicontextmenuinteractiondelegate-协议" class="header-anchor">#</a> <em>UIContextMenuInteractionDelegate</em> 协议</h4> <p>Providing the set of actions to perform on your content, and for customizing the preview of that content.</p> <h4 id="uicontextmenuconfiguration"><a href="#uicontextmenuconfiguration" class="header-anchor">#</a> UIContextMenuConfiguration</h4> <p>An object containing the configuration details for the contextual menu.</p> <h4 id="uitargetedpreview"><a href="#uitargetedpreview" class="header-anchor">#</a> UITargetedPreview</h4> <p>An object describing the view to use during preview-related animations.</p> <h4 id="uimenuelement-类"><a href="#uimenuelement-类" class="header-anchor">#</a> UIMenuElement 类</h4> <p>An object representing a menu, action, or command. 下面三个类（UIMenu, UIAction, UICommand）的父类，定义 title, image, attribute 和 state</p> <h4 id="uimenu-类"><a href="#uimenu-类" class="header-anchor">#</a> UIMenu 类</h4> <p>A container for grouping related menu elements in an app menu or contextual menu</p> <h4 id="uiaction-类"><a href="#uiaction-类" class="header-anchor">#</a> UIAction 类</h4> <p>A menu element that performs its action in a closure.</p> <h4 id="uicommand-类"><a href="#uicommand-类" class="header-anchor">#</a> UICommand 类</h4> <p>A menu element that performs its action in a selector.</p> <h4 id="uikeycommand-类-原来就有的-用于ipad-和-mac"><a href="#uikeycommand-类-原来就有的-用于ipad-和-mac" class="header-anchor">#</a> UIKeyCommand 类（原来就有的，用于iPad 和 Mac）</h4> <p>An object that specifies a key press performed on a hardware keyboard and the resulting action.</p> <h3 id="demo-2"><a href="#demo-2" class="header-anchor">#</a> Demo</h3> <p>3D Touch/Haptic Touch/Long press/Secondary click (Mac)，弹出菜单</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token builtin">UIViewController</span> <span class="token punctuation">{</span>
  <span class="token keyword">func</span> <span class="token function">addInteraction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create a UIContextMenuInteraction with Some Delegate</span>
    <span class="token keyword">let</span> interaction <span class="token operator">=</span> <span class="token function">UIContextMenuInteraction</span><span class="token punctuation">(</span>delegate<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">)</span>

    <span class="token comment">// Attach It to Our View</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>view<span class="token punctuation">.</span><span class="token function">addInteraction</span><span class="token punctuation">(</span>interaction<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Delegate</span>
<span class="token keyword">extension</span> <span class="token builtin">ViewController</span><span class="token punctuation">:</span> <span class="token builtin">UIContextMenuInteractionDelegate</span> <span class="token punctuation">{</span>
  <span class="token comment">/// 创建 menu content 和 content preview view controller (可选)</span>
  <span class="token keyword">func</span> <span class="token function">contextMenuInteraction</span><span class="token punctuation">(</span><span class="token number">_</span> interaction<span class="token punctuation">:</span> <span class="token builtin">UIContextMenuInteraction</span><span class="token punctuation">,</span> configurationForMenuAtLocation location<span class="token punctuation">:</span> <span class="token builtin">CGPoint</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">UIContextMenuConfiguration</span><span class="token operator">?</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> actionProvider <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>suggestedActions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">UIMenuElement</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">UIMenu</span><span class="token operator">?</span> <span class="token keyword">in</span>
      <span class="token keyword">let</span> editMenu <span class="token operator">=</span> <span class="token function">UIMenu</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string">&quot;Edit...&quot;</span><span class="token punctuation">,</span> children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token function">UIAction</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string">&quot;Copy&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">UIAction</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string">&quot;Duplicate&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token function">UIMenu</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token function">UIAction</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string">&quot;Share&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        editMenu<span class="token punctuation">,</span>
        <span class="token function">UIAction</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string">&quot;Delete&quot;</span><span class="token punctuation">,</span> attributes<span class="token punctuation">:</span> <span class="token punctuation">.</span>destructive<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">UIContextMenuConfiguration</span><span class="token punctuation">(</span>identifier<span class="token punctuation">:</span> <span class="token string">&quot;unique-ID&quot;</span> <span class="token keyword">as</span> <span class="token builtin">NSCopying</span><span class="token punctuation">,</span>
      previewProvider<span class="token punctuation">:</span> <span class="token constant">nil</span><span class="token punctuation">,</span>
      actionProvider<span class="token punctuation">:</span> actionProvider<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/// Returns the source view to use when animating the appearance of the preview interface.</span>
  <span class="token keyword">func</span> <span class="token function">contextMenuInteraction</span><span class="token punctuation">(</span><span class="token number">_</span> interaction<span class="token punctuation">:</span> <span class="token builtin">UIContextMenuInteraction</span><span class="token punctuation">,</span> previewForHighlightingMenuWithConfiguration configuration<span class="token punctuation">:</span> <span class="token builtin">UIContextMenuConfiguration</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">UITargetedPreview</span><span class="token operator">?</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> parameters <span class="token operator">=</span> <span class="token function">UIPreviewParameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    parameters<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token builtin">UIColor</span><span class="token punctuation">.</span>clear
    <span class="token keyword">let</span> visibleRect <span class="token operator">=</span> label<span class="token punctuation">.</span>bounds<span class="token punctuation">.</span><span class="token function">insetBy</span><span class="token punctuation">(</span>dx<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> dy<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> visiblePath <span class="token operator">=</span> <span class="token function">UIBezierPath</span><span class="token punctuation">(</span>roundedRect<span class="token punctuation">:</span> visibleRect<span class="token punctuation">,</span> cornerRadius<span class="token punctuation">:</span> <span class="token number">10.0</span><span class="token punctuation">)</span>
    parameters<span class="token punctuation">.</span>visiblePath <span class="token operator">=</span> visiblePath
    <span class="token keyword">return</span> <span class="token function">UITargetedPreview</span><span class="token punctuation">(</span>view<span class="token punctuation">:</span> label<span class="token punctuation">,</span> parameters<span class="token punctuation">:</span> parameters<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">/// Returns the destination view to use when animating the appearance of the preview interface.</span>
  <span class="token keyword">func</span> <span class="token function">contextMenuInteraction</span><span class="token punctuation">(</span><span class="token number">_</span> interaction<span class="token punctuation">:</span> <span class="token builtin">UIContextMenuInteraction</span><span class="token punctuation">,</span> previewForDismissingMenuWithConfiguration configuration<span class="token punctuation">:</span> <span class="token builtin">UIContextMenuConfiguration</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">UITargetedPreview</span><span class="token operator">?</span> <span class="token punctuation">{</span>
    
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h3 id="uitableview-and-uicollectionview"><a href="#uitableview-and-uicollectionview" class="header-anchor">#</a> UITableView and UICollectionView</h3> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">protocol</span> <span class="token builtin">UITableViewDelegate</span> <span class="token punctuation">{</span>
  <span class="token keyword">func</span> <span class="token function">tableView</span><span class="token punctuation">(</span><span class="token number">_</span> tableView<span class="token punctuation">:</span> <span class="token builtin">UITableView</span><span class="token punctuation">,</span> contextMenuConfigurationForRowAt indexPath<span class="token punctuation">:</span> <span class="token builtin">IndexPath</span><span class="token punctuation">,</span> point<span class="token punctuation">:</span> <span class="token builtin">CGPoint</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">UIContextMenuConfiguration</span><span class="token operator">?</span> 

  <span class="token keyword">func</span> <span class="token function">tableView</span><span class="token punctuation">(</span><span class="token number">_</span> tableView<span class="token punctuation">:</span> <span class="token builtin">UITableView</span><span class="token punctuation">,</span> previewForDismissingContextMenuWithConfiguration configuration<span class="token punctuation">:</span> <span class="token builtin">UIContextMenuConfiguration</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">UITargetedPreview</span><span class="token operator">?</span>
  
  <span class="token keyword">func</span> <span class="token function">tableView</span><span class="token punctuation">(</span><span class="token number">_</span> tableView<span class="token punctuation">:</span> <span class="token builtin">UITableView</span><span class="token punctuation">,</span> previewForHighlightingContextMenuWithConfiguration configuration<span class="token punctuation">:</span> <span class="token builtin">UIContextMenuConfiguration</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">UITargetedPreview</span><span class="token operator">?</span>
  
  <span class="token keyword">func</span> <span class="token function">tableView</span><span class="token punctuation">(</span><span class="token number">_</span> tableView<span class="token punctuation">:</span> <span class="token builtin">UITableView</span><span class="token punctuation">,</span> willPerformPreviewActionForMenuWith configuration<span class="token punctuation">:</span> <span class="token builtin">UIContextMenuConfiguration</span><span class="token punctuation">,</span> animator<span class="token punctuation">:</span> <span class="token builtin">UIContextMenuInteractionCommitAnimating</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><em>UICollectionViewDelegate</em> 类似</p> <h3 id="peek-and-pop-deprecated"><a href="#peek-and-pop-deprecated" class="header-anchor">#</a> Peek and Pop (deprecated)</h3> <p><em>UIViewControllerPreviewing</em> is deprecated，使用 <em>UIContextMenuInteraction</em> 代替</p></div></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#flexible-ui" title="Flexible UI">Flexible UI</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#launch-storyboards" title="Launch Storyboards">Launch Storyboards</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#bars" title="Bars">Bars</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#new" title="New">New</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#deprecated" title="Deprecated">Deprecated</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#presentations" title="Presentations">Presentations</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#重新设计uimodalpresentationstyle的-pagesheet-和-formsheet" title="重新设计UIModalPresentationStyle的 .pageSheet 和 .formSheet">重新设计UIModalPresentationStyle的 .pageSheet 和 .formSheet</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#新增并默认-automatic" title="新增并默认 .automatic">新增并默认 .automatic</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#pagesheet-和-formsheet-禁止手势-dismiss" title=".pageSheet 和 .formSheet 禁止手势 dismiss">.pageSheet 和 .formSheet 禁止手势 dismiss</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#search" title="Search">Search</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#新增属性" title="新增属性">新增属性</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#search-token" title="Search token">Search token</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#textualrange-in-uisearchtextfield" title="textualRange (in UISearchTextField)">textualRange (in UISearchTextField)</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#gestures" title="Gestures">Gestures</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#selection-gestures-in-custom-text-views" title="Selection gestures in custom text views">Selection gestures in custom text views</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#multiple-selection-gestures-in-tables-and-collections" title="Multiple selection gestures in tables and collections">Multiple selection gestures in tables and collections</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#editing-gestures" title="Editing gestures">Editing gestures</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#menus" title="Menus">Menus</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#demo-2" title="Demo">Demo</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#uitableview-and-uicollectionview" title="UITableView and UICollectionView">UITableView and UICollectionView</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#peek-and-pop-deprecated" title="Peek and Pop (deprecated)">Peek and Pop (deprecated)</a></div></div></div></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.b07256e7.js" defer></script><script src="/assets/js/34.49b71b2c.js" defer></script><script src="/assets/js/5.373c53f3.js" defer></script><script src="/assets/js/73.c3dcfd4b.js" defer></script>
  </body>
</html>
