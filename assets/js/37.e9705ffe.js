(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{294:function(e,t,a){e.exports=a.p+"assets/img/commit-message-cz.798aa917.png"},295:function(e,t,a){e.exports=a.p+"assets/img/commit-message-lint.2a9a7fb5.png"},296:function(e,t,a){e.exports=a.p+"assets/img/commit-message-prompt.e05dfe42.png"},512:function(e,t,a){"use strict";a.r(t);var s=a(4),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"规范化-commit-message"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#规范化-commit-message"}},[e._v("#")]),e._v(" 规范化 Commit Message")]),e._v(" "),s("p",[e._v("我们知道，git 每次提交代码，都要写 commit message，否则就不允许提交。例如")]),e._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" commit -m "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"hello world"')]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("如果一行不够，可以只执行"),s("code",[e._v("git commit")]),e._v("，就会跳出文本编辑器，让你写多行。")]),e._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" commit\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("基本上，你写什么都行。但是在一个多人协作的项目中，我们还是需要规范化我们的 commit message。")]),e._v(" "),s("h2",{attrs:{id:"commit-message-的作用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commit-message-的作用"}},[e._v("#")]),e._v(" Commit message 的作用")]),e._v(" "),s("p",[e._v("规范化的 commit message，有什么好处呢？")]),e._v(" "),s("ol",[s("li",[e._v("提供更多的历史信息，方便快速浏览")])]),e._v(" "),s("p",[e._v("例如，运行下面的命令显示上次发布后的变动，每个 commit 占据一行，你只看行首，就知道某次 commit 的目的。")]),e._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" log "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("last tag"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" HEAD --pretty"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("format:%s\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[e._v("以过滤某些 commit，便于快速查找信息")])]),e._v(" "),s("p",[e._v("例如，下面的命令仅仅显示本次发布新增加的功能。")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" log "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("last release"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" HEAD --grep feature\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("ol",{attrs:{start:"3"}},[s("li",[e._v("可以直接从 commit 生成 change log")])]),e._v(" "),s("p",[e._v("Change log 是发布新版本时，用来说明与上一个版本差异的文档。下面会详细介绍")]),e._v(" "),s("h2",{attrs:{id:"commit-message-的格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commit-message-的格式"}},[e._v("#")]),e._v(" Commit message 的格式")]),e._v(" "),s("p",[e._v("根据 "),s("a",{attrs:{href:"https://www.conventionalcommits.org/en/v1.0.0/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Conventional Commits"),s("OutboundLink")],1),e._v("，commit message 有三个部分组成，header, body 和 footer(s)")]),e._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("type"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("optional scope"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(": "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("description"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n// 空一行\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("optional body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n// 空一行\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("optional footer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("这里只有 header 是必选的，body 和 footer 是可选的，footer 可以有多个。")]),e._v(" "),s("h3",{attrs:{id:"message-header"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#message-header"}},[e._v("#")]),e._v(" Message Header")]),e._v(" "),s("p",[e._v("Header 部分只有一行，包括三个字段："),s("code",[e._v("type")]),e._v("、"),s("code",[e._v("scope")]),e._v(" 和 "),s("code",[e._v("description")]),e._v("，其中 "),s("code",[e._v("scope")]),e._v(" 是可选的。")]),e._v(" "),s("h4",{attrs:{id:"type"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#type"}},[e._v("#")]),e._v(" Type")]),e._v(" "),s("p",[s("strong",[e._v("必须")]),e._v("，"),s("code",[e._v("type")]),e._v(" 用于说明 commit 的类别， "),s("a",{attrs:{href:"https://www.conventionalcommits.org/en/v1.0.0/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Conventional Commits "),s("OutboundLink")],1),e._v(" 主要定义了两种类型，对应于版本好的管理 "),s("a",{attrs:{href:"https://semver.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Semantic Versioning"),s("OutboundLink")],1),e._v("。")]),e._v(" "),s("ul",[s("li",[s("strong",[e._v("feat")]),e._v(": 增加新功能，对应 "),s("strong",[e._v("MINOR")])]),e._v(" "),s("li",[s("strong",[e._v("fix")]),e._v(": 修复 bug，对应 "),s("strong",[e._v("PATCH")])])]),e._v(" "),s("p",[e._v("其它类型可以根据自己的项目，自由添加")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/angular/angular/blob/22b96b9/CONTRIBUTING.md#-commit-message-guidelines",target:"_blank",rel:"noopener noreferrer"}},[e._v("Angular Commit Message Guidelines"),s("OutboundLink")],1),e._v(" 定义了下面十种 type")]),e._v(" "),s("ul",[s("li",[s("strong",[e._v("feat")]),e._v(": 增加新功能")]),e._v(" "),s("li",[s("strong",[e._v("fix")]),e._v(": 修复 bug")]),e._v(" "),s("li",[s("strong",[e._v("build")]),e._v(": 更改构建系统或外部依赖(例如：gulp, broccoli, npm)")]),e._v(" "),s("li",[s("strong",[e._v("ci")]),e._v(": 更改CI配置文件和脚本(例如：Travis, Circle, BrowserStack, SauceLabs)")]),e._v(" "),s("li",[s("strong",[e._v("docs")]),e._v(": 更改文档")]),e._v(" "),s("li",[s("strong",[e._v("perf")]),e._v(": 提高性能的修改")]),e._v(" "),s("li",[s("strong",[e._v("refactor")]),e._v(": 重构，但是即不是新增功能，也不是修复 bug")]),e._v(" "),s("li",[s("strong",[e._v("style")]),e._v(": 修改格式或样式，但是不会影响代码的运行(例如：删除空白、添加分号等)")]),e._v(" "),s("li",[s("strong",[e._v("test")]),e._v(": 添加测试")]),e._v(" "),s("li",[s("strong",[e._v("chore")]),e._v(":  其它不修改 src 或测试文件的更改")])]),e._v(" "),s("h4",{attrs:{id:"scope"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#scope"}},[e._v("#")]),e._v(" Scope")]),e._v(" "),s("p",[s("strong",[e._v("可选")]),e._v("，用于说明 commit 影响的范围，比如数据层、控制层、视图层等等，视项目不同而不同")]),e._v(" "),s("h4",{attrs:{id:"description"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#description"}},[e._v("#")]),e._v(" Description")]),e._v(" "),s("p",[s("strong",[e._v("必须")]),e._v("，是 commit 目的的简短描述")]),e._v(" "),s("p",[e._v("在 Angular 规范中，这一部分定义为 "),s("code",[e._v("subject")]),e._v(" ，有以下规则")]),e._v(" "),s("ul",[s("li",[e._v("以动词开头，使用第一人称现在时，比如 "),s("code",[e._v("change")]),e._v("，而不是 "),s("code",[e._v("changed")]),e._v(" 或 "),s("code",[e._v("changes")])]),e._v(" "),s("li",[e._v("第一个字母小写")]),e._v(" "),s("li",[e._v("结尾不加句号（"),s("code",[e._v(".")]),e._v("）")])]),e._v(" "),s("h3",{attrs:{id:"message-body"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#message-body"}},[e._v("#")]),e._v(" Message Body")]),e._v(" "),s("p",[s("strong",[e._v("可选")]),e._v("，是对本次 commit 的详细描述，可以分成多行")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("使用第一人称现在时，比如使用 "),s("code",[e._v("change")]),e._v(" 而不是 "),s("code",[e._v("changed")]),e._v(" 或 "),s("code",[e._v("changes")]),e._v("。")])]),e._v(" "),s("li",[s("p",[e._v("应该说明代码变动的动机，以及与以前行为的对比。")])])]),e._v(" "),s("h3",{attrs:{id:"message-footer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#message-footer"}},[e._v("#")]),e._v(" Message Footer")]),e._v(" "),s("p",[s("strong",[e._v("可选")]),e._v("，可以存在多个。有两种类型的 footer")]),e._v(" "),s("h4",{attrs:{id:"breaking-change"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#breaking-change"}},[e._v("#")]),e._v(" BREAKING CHANGE")]),e._v(" "),s("p",[e._v("不兼容的变动，对应 "),s("a",{attrs:{href:"https://semver.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Semantic Versioning"),s("OutboundLink")],1),e._v(" 的 "),s("strong",[e._v("MAJOR")]),e._v("，例如")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("BREAKING CHANGE: `extends` key in config file is now used for extending other config files\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("对应不兼容的变动，也可以通过在 type(scope) 后面添加一个 "),s("code",[e._v("!")]),e._v(" 进行表示，适用于任意 type。例如")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("feat(api)!: send an email to the customer when a product is shipped\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"其它"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其它"}},[e._v("#")]),e._v(" 其它")]),e._v(" "),s("p",[e._v("其它的 footer 视项目情况而定，其规范类似于 "),s("a",{attrs:{href:"https://git-scm.com/docs/git-interpret-trailers",target:"_blank",rel:"noopener noreferrer"}},[e._v("git trailer format"),s("OutboundLink")],1),e._v("，一般格式如下：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("<word token>: <descrption>\n# 或者\n<word token># <descrption>\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[s("code",[e._v("word token")]),e._v(" 多个单词中间用连词符，比如 "),s("code",[e._v("Acked-by")])]),e._v(" "),s("p",[s("code",[e._v("descrption")]),e._v("可以有多行")]),e._v(" "),s("p",[e._v("下面是 footer 的例子")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Reviewed-by: Z\nRefs: #123\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("h4",{attrs:{id:"关闭-issues"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关闭-issues"}},[e._v("#")]),e._v(" 关闭 issues")]),e._v(" "),s("p",[e._v("Angular 规范还定义了一种footer，就是关闭 issues，使用 "),s("code",[e._v("Closes")]),e._v(" 关键字，例如")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Closes #123, #245, #992\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"revert"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#revert"}},[e._v("#")]),e._v(" revert")]),e._v(" "),s("p",[e._v("还有一种特殊情况，如果当前 commit 用于撤销以前的 commit，则必须以 "),s("code",[e._v("revert:")]),e._v(" 开头，后面跟着被撤销 commit 的 header。body 部分的格式是固定的，必须写成 "),s("code",[e._v("This reverts commit <hash>.")]),e._v("，其中的 "),s("code",[e._v("hash")]),e._v(" 被撤销 commit 的 SHA 标识符。例如")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("revert: feat(pencil): add 'graphiteWidth' option\n\nThis reverts commit 667ecc1654a317a13331b17617d973392f415f02.\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[e._v("如果当前 commit 与被撤销的 commit，在同一个发布（release）里面，那么它们都不会出现在 change log 里面。如果两者在不同的发布，那么当前 commit，会出现在 change log 的 "),s("code",[e._v("Reverts")]),e._v(" 小标题下面。")]),e._v(" "),s("h3",{attrs:{id:"specification"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specification"}},[e._v("#")]),e._v(" Specification")]),e._v(" "),s("p",[e._v("更加详细的规范与建议可以参考 Conventional Commits 的 "),s("a",{attrs:{href:"https://www.conventionalcommits.org/en/v1.0.0/#specification",target:"_blank",rel:"noopener noreferrer"}},[e._v("Specification"),s("OutboundLink")],1),e._v(" 与 "),s("a",{attrs:{href:"https://www.conventionalcommits.org/en/v1.0.0/#faq",target:"_blank",rel:"noopener noreferrer"}},[e._v("FAQ"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"commitizen"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commitizen"}},[e._v("#")]),e._v(" Commitizen")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/commitizen/cz-cli",target:"_blank",rel:"noopener noreferrer"}},[e._v("Commitizen"),s("OutboundLink")],1),e._v(" 是一个引导我们提交规范化 commit message 的工具。Commitizen 采用 "),s("a",{attrs:{href:"https://github.com/angular/angular/blob/22b96b9/CONTRIBUTING.md#-commit-message-guidelines",target:"_blank",rel:"noopener noreferrer"}},[e._v("Angular Commit Message Guidelines"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[e._v("#")]),e._v(" 安装")]),e._v(" "),s("p",[e._v("首先全局安装 Commitizen CLI 工具")]),e._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g commitizen\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("然后，在项目里，运行下面的命令安装 "),s("a",{attrs:{href:"https://github.com/commitizen/cz-conventional-changelog",target:"_blank",rel:"noopener noreferrer"}},[e._v("cz-conventional-changelog"),s("OutboundLink")],1),e._v("，使其支持 "),s("a",{attrs:{href:"https://github.com/angular/angular/blob/22b96b9/CONTRIBUTING.md#-commit-message-guidelines",target:"_blank",rel:"noopener noreferrer"}},[e._v("Angular Commit Message Guidelines"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ commitizen init cz-conventional-changelog --save-dev --save-exact\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# yarn install")]),e._v("\n$ commitizen init cz-conventional-changelog --yarn --dev --exact\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("这个命名除了安装 "),s("code",[e._v("cz-conventional-changelog")]),e._v(" 依赖以外，也在  "),s("code",[e._v("package.json")]),e._v(" 文件里添加了 "),s("code",[e._v("config.commitizen")]),e._v(" 配置项")]),e._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"config"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"commitizen"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"path"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"./node_modules/cz-conventional-changelog"')]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("这个配置项也可以写在一个 "),s("code",[e._v(".czrc")]),e._v(" 文件里，详细的配置可以参考 "),s("a",{attrs:{href:"https://github.com/commitizen/cz-conventional-changelog",target:"_blank",rel:"noopener noreferrer"}},[e._v("cz-conventional-changelog"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"全局使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全局使用"}},[e._v("#")]),e._v(" 全局使用")]),e._v(" "),s("p",[e._v("在提交 commit 的时候用 "),s("code",[e._v("git cz")]),e._v(" 代替 "),s("code",[e._v("git commit")]),e._v("，它就会一步一步引导你输入规范化 commit message。")]),e._v(" "),s("p",[s("img",{attrs:{src:a(294),alt:""}})]),e._v(" "),s("h3",{attrs:{id:"本地使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#本地使用"}},[e._v("#")]),e._v(" 本地使用")]),e._v(" "),s("p",[e._v("本地使用的好处是保证团队所有的开发者运行相同版本的 Commitizen.")]),e._v(" "),s("p",[e._v("首先本地安装 Commitizen CLI 工具")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" commitizen -D\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("然后，本地安装 "),s("a",{attrs:{href:"https://github.com/commitizen/cz-conventional-changelog",target:"_blank",rel:"noopener noreferrer"}},[e._v("cz-conventional-changelog"),s("OutboundLink")],1)]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ npx commitizen init cz-conventional-changelog --save-dev --save-exact\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("最后在 "),s("code",[e._v("package.json")]),e._v(" 文件里添加 npm 脚本")]),e._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"cz"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"cz"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[e._v("或者使用下面的命令添加")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" set-script cz cz\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("现在提交 commit 的时候用 "),s("code",[e._v("npx run cz")]),e._v(" 代替 "),s("code",[e._v("git commit")])]),e._v(" "),s("h3",{attrs:{id:"配合-husky-使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配合-husky-使用"}},[e._v("#")]),e._v(" 配合 husky 使用")]),e._v(" "),s("p",[e._v("上面的方法对于不了解 Commitizen 的开发者并不友好，他们可能不知道用 "),s("code",[e._v("npx run cz")]),e._v(" 代替 "),s("code",[e._v("git commit")]),e._v("。最好的方式是当他们使用 "),s("code",[e._v("git commit")]),e._v(" 就能调用Commitizen，出现引导页。这个可以通过 "),s("a",{attrs:{href:"https://www.npmjs.com/package/husky",target:"_blank",rel:"noopener noreferrer"}},[e._v("husky"),s("OutboundLink")],1),e._v(" 来实现。")]),e._v(" "),s("blockquote",[s("p",[e._v("前提条件是在本地安装 Commitizen CLI 工具")])]),e._v(" "),s("p",[e._v("首先安装 "),s("a",{attrs:{href:"https://www.npmjs.com/package/husky",target:"_blank",rel:"noopener noreferrer"}},[e._v("husky"),s("OutboundLink")],1)]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" husky -D\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("然后运行 hasky")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ npx husky "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 或者")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" set-script prepare "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"husky install"')]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" run prepare\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("最后配置 Commitizen")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ npx husky "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" .husky/prepare-commit-msg "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"exec < /dev/tty && npx cz --hook || true"')]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("当我们运行 "),s("code",[e._v("git commit")]),e._v(" 就会弹出引导页")]),e._v(" "),s("h3",{attrs:{id:"adapter"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adapter"}},[e._v("#")]),e._v(" Adapter")]),e._v(" "),s("p",[e._v("除了 "),s("a",{attrs:{href:"https://www.npmjs.com/package/cz-conventional-changelog",target:"_blank",rel:"noopener noreferrer"}},[e._v("cz-conventional-changelog"),s("OutboundLink")],1),e._v(" 还有很多第三方的引导"),s("a",{attrs:{href:"https://github.com/commitizen/cz-cli#adapters",target:"_blank",rel:"noopener noreferrer"}},[e._v("适配器"),s("OutboundLink")],1),e._v("，比如 "),s("a",{attrs:{href:"https://github.com/ngryman/cz-emoji",target:"_blank",rel:"noopener noreferrer"}},[e._v("cz-emoji"),s("OutboundLink")],1),e._v("，有兴趣地可以去试试看。")]),e._v(" "),s("h2",{attrs:{id:"commitlint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commitlint"}},[e._v("#")]),e._v(" commitlint")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/commitizen/cz-cli",target:"_blank",rel:"noopener noreferrer"}},[e._v("Commitizen"),s("OutboundLink")],1),e._v(" 是引导开发者提交规范化 commit message，而 "),s("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint",target:"_blank",rel:"noopener noreferrer"}},[e._v("commitlint"),s("OutboundLink")],1),e._v(" 则是校验 commit message 是否规范化。")]),e._v(" "),s("p",[s("code",[e._v("commitlint")]),e._v(" 支持多个 scope，可以用 "),s("code",[e._v('"/"')]),e._v("、"),s("code",[e._v('"\\"')]),e._v("、 "),s("code",[e._v('","')]),e._v(" 进行分隔。")]),e._v(" "),s("h3",{attrs:{id:"安装-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-2"}},[e._v("#")]),e._v(" 安装")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -D @commitlint/cli @commitlint/config-conventional\n\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("\"module.exports = {extends: ['@commitlint/config-conventional']}\"")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" commitlint.config.js\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[s("code",[e._v("@commitlint/cli")]),e._v(" 就是 "),s("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint",target:"_blank",rel:"noopener noreferrer"}},[e._v("commitlint"),s("OutboundLink")],1),e._v(" 校验工具，"),s("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint/tree/master/%40commitlint/config-conventional",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@commitlint/config-conventional")]),s("OutboundLink")],1),e._v(" 定义了默认的验证规则。除了这个还有很多的 "),s("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint#shared-configuration",target:"_blank",rel:"noopener noreferrer"}},[e._v("共享配置"),s("OutboundLink")],1),e._v("。")]),e._v(" "),s("p",[s("code",[e._v("commitlint.config.js")]),e._v(" 是 commitlint 的配置文件，使用 "),s("code",[e._v("@commitlint/config-conventional")]),e._v(" 定义的默认配置，但是用户可以修改。")]),e._v(" "),s("h3",{attrs:{id:"配置-husky"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-husky"}},[e._v("#")]),e._v(" 配置 husky")]),e._v(" "),s("p",[s("code",[e._v("husky")]),e._v(" 安装和上面 "),s("a",{attrs:{href:"#%E9%85%8D%E5%90%88-husky-%E4%BD%BF%E7%94%A8"}},[e._v("配合 husky 使用")]),e._v(" 一样，然后配置 "),s("code",[e._v("husky")]),e._v(" "),s("code",[e._v("commit-msg")])]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ npx husky "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" .husky/commit-msg "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'npx --no -- commitlint --edit "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$1")]),e._v("'")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[e._v("#")]),e._v(" 使用")]),e._v(" "),s("p",[e._v("当我们提交不规范的 commit message 的时候，"),s("code",[e._v("commitlint")]),e._v(" 就会拒绝我们的提交。")]),e._v(" "),s("p",[s("img",{attrs:{src:a(295),alt:""}})]),e._v(" "),s("h3",{attrs:{id:"引导"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引导"}},[e._v("#")]),e._v(" 引导")]),e._v(" "),s("p",[s("code",[e._v("commitlint")]),e._v(" 也提供了类似于 "),s("code",[e._v("Commitizen")]),e._v(" 的引导功能，有两种方式")]),e._v(" "),s("h4",{attrs:{id:"commitlint-prompt-cli"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commitlint-prompt-cli"}},[e._v("#")]),e._v(" @commitlint/prompt-cli")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint/tree/master/%40commitlint/prompt-cli",target:"_blank",rel:"noopener noreferrer"}},[e._v("@commitlint/prompt-cli"),s("OutboundLink")],1),e._v(" 是一个 cli 工具，提供了类似 "),s("code",[e._v("Commitizen")]),e._v(" 的引导功能。")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 安装")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" --save-dev @commitlint/prompt-cli\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 添加 script")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" set-script commit commit\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 运行")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" run commit\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br")])]),s("p",[e._v("运行效果图")]),e._v(" "),s("p",[s("img",{attrs:{src:a(296),alt:""}})]),e._v(" "),s("p",[e._v("从上面这个图，我们可以看到这个效果是不如 "),s("code",[e._v("Commitizen")]),e._v(" 的")]),e._v(" "),s("h4",{attrs:{id:"commitizen-适配器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commitizen-适配器"}},[e._v("#")]),e._v(" Commitizen 适配器")]),e._v(" "),s("p",[s("code",[e._v("commitlint")]),e._v(" 提供了两个适配器用来替换 "),s("a",{attrs:{href:"https://github.com/commitizen/cz-conventional-changelog",target:"_blank",rel:"noopener noreferrer"}},[e._v("cz-conventional-changelog"),s("OutboundLink")],1)]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/prompt",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@commitlint/prompt")]),s("OutboundLink")],1),e._v(" 提供类似于 "),s("code",[e._v("@commitlint/prompt-cli")]),e._v(" 的功能")]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/cz-commitlint",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@commitlint/cz-commitlint")]),s("OutboundLink")],1),e._v(" 类似于 "),s("code",[e._v("cz-conventional-changelog")])])]),e._v(" "),s("h3",{attrs:{id:"自定义配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义配置"}},[e._v("#")]),e._v(" 自定义配置")]),e._v(" "),s("p",[s("code",[e._v("commitlint")]),e._v(" 可以通过修改 "),s("code",[e._v("commitlint.config.js")]),e._v(" 进行自定义的配置，包括 "),s("a",{attrs:{href:"https://commitlint.js.org/#/concepts-shareable-config",target:"_blank",rel:"noopener noreferrer"}},[e._v("Shareable configuration"),s("OutboundLink")],1),e._v("、"),s("a",{attrs:{href:"https://commitlint.js.org/#/reference-rules",target:"_blank",rel:"noopener noreferrer"}},[e._v("Rules"),s("OutboundLink")],1),e._v(" 和 "),s("a",{attrs:{href:"https://commitlint.js.org/#/reference-plugins",target:"_blank",rel:"noopener noreferrer"}},[e._v("Plugins"),s("OutboundLink")],1)]),e._v(" "),s("h3",{attrs:{id:"ci-设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ci-设置"}},[e._v("#")]),e._v(" CI 设置")]),e._v(" "),s("p",[e._v("通过上面的配置，可以能保障在项目里提交 commit 的时候，通过 "),s("code",[e._v("commitlint")]),e._v(" 拒绝不规范的 message，但是如果不在项目里提交呢，比如在源码托管服务里提交 commit 呢？这个时候就需要进行 "),s("a",{attrs:{href:"https://commitlint.js.org/#/guides-ci-setup",target:"_blank",rel:"noopener noreferrer"}},[e._v("CI 设置"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("h2",{attrs:{id:"生成-change-log"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生成-change-log"}},[e._v("#")]),e._v(" 生成 Change Log")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/conventional-changelog/conventional-changelog/tree/master/packages/conventional-changelog-cli",target:"_blank",rel:"noopener noreferrer"}},[e._v("conventional-changelog-cli"),s("OutboundLink")],1),e._v(" 是一个根据你的 commit messag 自动生成 change log 的工具")]),e._v(" "),s("h3",{attrs:{id:"安装-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-3"}},[e._v("#")]),e._v(" 安装")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g conventional-changelog-cli\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"使用-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-2"}},[e._v("#")]),e._v(" 使用")]),e._v(" "),s("p",[e._v('生成自上次 tag 之后的 change log，包括 "Feature", "Fix", "Performance Improvement" 和 "Breaking Changes".')]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 全局安装，也可以本地安装")]),e._v("\n$ conventional-changelog -p angular -i CHANGELOG.md -s\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("第一次使用，生成所有的 change log")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ conventional-changelog -p angular -i CHANGELOG.md -s -r "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("查看所有参数")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ conventional-changelog --help\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("ul",[s("li",[e._v("-p 指定预设的名称，必须是这些 angular, atom, codemirror, conventionalcommits, ember, eslint, express, jquery 或者 jshint")]),e._v(" "),s("li",[e._v("-i 输入的文件名")]),e._v(" "),s("li",[e._v("-s 输入和输出同名")]),e._v(" "),s("li",[e._v("-r 生成最新多少版本的变更日志（默认值：1），如果是0，则生成整个变更日志，并覆盖输出文件。")])]),e._v(" "),s("h3",{attrs:{id:"推荐的工作流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#推荐的工作流程"}},[e._v("#")]),e._v(" 推荐的工作流程")]),e._v(" "),s("ol",[s("li",[e._v("修改代码")]),e._v(" "),s("li",[e._v("commit")]),e._v(" "),s("li",[e._v("bump "),s("code",[e._v("package.json")]),e._v(" 的版本号")]),e._v(" "),s("li",[e._v("运行 conventional-changelog 生成变更日志")]),e._v(" "),s("li",[e._v("commit  "),s("code",[e._v("package.json")]),e._v(" 和 "),s("code",[e._v("CHANGELOG.md")])]),e._v(" "),s("li",[e._v("tag")]),e._v(" "),s("li",[e._v("push")])]),e._v(" "),s("h4",{attrs:{id:"使用-npm-version"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-npm-version"}},[e._v("#")]),e._v(" 使用  "),s("code",[e._v("npm version")])]),e._v(" "),s("p",[e._v("使用  "),s("code",[e._v("npm version")]),e._v("，可以简化流程，首页添加下面脚本")]),e._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"conventional-changelog -p angular -i CHANGELOG.md -s && git add CHANGELOG.md"')]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("然后执行下面的流程")]),e._v(" "),s("ol",[s("li",[e._v("修改代码")]),e._v(" "),s("li",[e._v("commit")]),e._v(" "),s("li",[e._v("pull 所有的 tags")]),e._v(" "),s("li",[e._v("运行 "),s("a",{attrs:{href:"https://docs.npmjs.com/cli/version",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("npm version [patch|minor|major]")]),s("OutboundLink")],1)]),e._v(" "),s("li",[e._v("push")])]),e._v(" "),s("p",[e._v("最后还可以通过设置  "),s("code",[e._v(".npmrc")]),e._v(" 文件，自动化你的提交消息，并设置 tag 前缀")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('tag-version-prefix=""\nmessage="chore(release): %s :tada:"\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("h2",{attrs:{id:"standard-version"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#standard-version"}},[e._v("#")]),e._v(" standard-version")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/conventional-changelog/standard-version",target:"_blank",rel:"noopener noreferrer"}},[e._v("standard-version"),s("OutboundLink")],1),e._v(" 是一个自动修改版本号（bump version）、生成 tag 以及生成 change log 的工具，可以替换 "),s("a",{attrs:{href:"https://docs.npmjs.com/cli/version",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("npm version")]),s("OutboundLink")],1)]),e._v(" "),s("p",[s("code",[e._v("standard-version")]),e._v(" 使用预设的 "),s("a",{attrs:{href:"https://github.com/conventional-changelog/conventional-changelog/tree/master/packages/conventional-changelog-conventionalcommits",target:"_blank",rel:"noopener noreferrer"}},[e._v("conventionalcommits"),s("OutboundLink")],1),e._v("，遵循 "),s("a",{attrs:{href:"https://www.conventionalcommits.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("conventionalcommits.org"),s("OutboundLink")],1),e._v(" 规范，可配，具体配置选项请参考 "),s("a",{attrs:{href:"https://github.com/conventional-changelog/conventional-changelog-config-spec",target:"_blank",rel:"noopener noreferrer"}},[e._v("conventional-changelog-config-spec"),s("OutboundLink")],1),e._v("。")]),e._v(" "),s("h3",{attrs:{id:"安装-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-4"}},[e._v("#")]),e._v(" 安装")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 本地安装")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" standard-version -D\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 添加一个脚本")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" set-script release standard-version\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h3",{attrs:{id:"使用-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-3"}},[e._v("#")]),e._v(" 使用")]),e._v(" "),s("ol",[s("li",[e._v("修改代码")]),e._v(" "),s("li",[e._v("commit")]),e._v(" "),s("li",[e._v("运行 "),s("code",[e._v("standard-version")])])]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" run release\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("剩下的事 "),s("code",[e._v("standard-version")]),e._v(" 全帮你做完了")]),e._v(" "),s("ol",[s("li",[e._v("bump "),s("code",[e._v("package.json")]),e._v(" 和 "),s("code",[e._v("package-lock.json")]),e._v("  的版本号")]),e._v(" "),s("li",[e._v("生成了变更日志 "),s("code",[e._v("CHANGELOG.md")])]),e._v(" "),s("li",[e._v("commit  "),s("code",[e._v("package.json")]),e._v(" 、"),s("code",[e._v("package-lock.json")]),e._v("  和 "),s("code",[e._v("CHANGELOG.md")]),e._v("。commit message 格式是 "),s("code",[e._v("chore(release): #version")])]),e._v(" "),s("li",[e._v('生成了新的 tag，默认前缀是 "#"，可以通过 '),s("code",[e._v("-t")]),e._v(" 进行修改")])]),e._v(" "),s("p",[e._v("第一次 release，运行下面的命令")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" run release -- --first-release\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("更多的操作，可以运行 "),s("code",[e._v("standard-version --help")]),e._v(" 或者参考 "),s("a",{attrs:{href:"https://github.com/conventional-changelog/standard-version",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方文档"),s("OutboundLink")],1),e._v("。")]),e._v(" "),s("h2",{attrs:{id:"semantic-release"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#semantic-release"}},[e._v("#")]),e._v(" semantic-release")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/semantic-release/semantic-release",target:"_blank",rel:"noopener noreferrer"}},[e._v("semantic-release"),s("OutboundLink")],1),e._v(" 和 "),s("a",{attrs:{href:"https://github.com/conventional-changelog/standard-version",target:"_blank",rel:"noopener noreferrer"}},[e._v("standard-version"),s("OutboundLink")],1),e._v(" 一样，是一个自动修改版本号（bump version）、生成 tag 以及生成 change log 的工具。此外它还能 publish release 包等 "),s("a",{attrs:{href:"https://github.com/semantic-release/semantic-release#highlights",target:"_blank",rel:"noopener noreferrer"}},[e._v("其它功能"),s("OutboundLink")],1),e._v("。要搭配 CI 一起使用。")]),e._v(" "),s("p",[e._v("这部分内容等我学习完 CI 再回过头来写。")]),e._v(" "),s("h2",{attrs:{id:"references"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[e._v("#")]),e._v(" References")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.conventionalcommits.org/en/v1.0.0/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Conventional Commits"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/angular/angular/blob/22b96b9/CONTRIBUTING.md#-commit-message-guidelines",target:"_blank",rel:"noopener noreferrer"}},[e._v("Angular Commit Message Guidelines"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/commitizen/cz-cli",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("commitizen/cz-cli")]),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("conventional-changelog/commitlint")]),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/conventional-changelog/conventional-changelog",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("conventional-changelo/conventional-changelog")]),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/conventional-changelog/standard-version",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("conventional-changelog/standard-version")]),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/semantic-release/semantic-release",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("semantic-release/semantic-release")]),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Commit message 和 Change log 编写指南"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://www.yuque.com/arvinxx-fe/workflow/gitmoji-commit-workflow",target:"_blank",rel:"noopener noreferrer"}},[e._v("Gitmoji Commit Workflow 完全指南"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/ngryman/cz-emoji",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("ngryman/cz-emoji")]),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/carloscuesta/gitmoji",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("carloscuesta/gitmoji")]),s("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);