(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{352:function(t,s,a){t.exports=a.p+"assets/img/github-actions-select-branch.76c3cadb.png"},353:function(t,s,a){t.exports=a.p+"assets/img/github-actions-pages-build-deployment.3b3f0c8e.png"},354:function(t,s,a){t.exports=a.p+"assets/img/github-actions-default-action.5846406c.png"},355:function(t,s,a){t.exports=a.p+"assets/img/github-actions-sudoku.dda89589.png"},356:function(t,s,a){t.exports=a.p+"assets/img/github-actions-json-vs-yaml.c50c7c31.png"},357:function(t,s,a){t.exports=a.p+"assets/img/github-actions-workflow.ab3e456e.png"},358:function(t,s,a){t.exports=a.p+"assets/img/github-actions-starter-workflows.e1480837.png"},359:function(t,s,a){t.exports=a.p+"assets/img/github-actions-marketplace.5871c672.png"},360:function(t,s,a){t.exports=a.p+"assets/img/github-actions-auto.dfb23139.png"},361:function(t,s,a){t.exports=a.p+"assets/img/github-actions-default-build.ba32d648.png"},534:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"github-自动化部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#github-自动化部署"}},[t._v("#")]),t._v(" GitHub 自动化部署")]),t._v(" "),n("p",[t._v("最近我的女儿迷恋上玩数独游戏，有一天她问我：“这一关你会不会啊?”。 我一看盘面上只有 17 个数字，这太难了吧，但是作为父亲不能说不会，于是我去 "),n("a",{attrs:{href:"https://sudoku.com/zh/shu-du-gui-ze/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sudoku.com"),n("OutboundLink")],1),t._v(" 网站上学习了一下数独，并且开发了一个 "),n("a",{attrs:{href:"https://github.com/cp3hnu/Sudoku",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sudoku"),n("OutboundLink")],1),t._v(" 数独推算应用。但是我没有服务器怎么部署我的应用呢？于是我想到了 Github 可以部署，也正好可以学习一下怎么在 Github 上部署前端应用。")]),t._v(" "),n("h2",{attrs:{id:"github-pages"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#github-pages"}},[t._v("#")]),t._v(" GitHub Pages")]),t._v(" "),n("p",[t._v("GitHub Pages 是一项静态站点托管服务，它直接从 GitHub 上的代码仓库获取 HTML、CSS 和 JavaScript 文件，通过构建过程运行文件，然后发布网站。所以我们可以使用 GitHub Pages 来展示博客、开源项目、获取分享简历，比如我的这个博客就是用 "),n("a",{attrs:{href:"https://vuepress.vuejs.org/zh/guide/deploy.html#github-pages",target:"_blank",rel:"noopener noreferrer"}},[t._v("VuePress"),n("OutboundLink")],1),t._v(" 开发，然后部署在我的 GitHub 主页上。")]),t._v(" "),n("p",[t._v("创建 GitHub Pages 有两种方式")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("Deploy from a branch")]),t._v("，从固定分支上部署，当 push 代码到这个分支时，Github 会自动从这个分支拉取代码进行部署")]),t._v(" "),n("li",[n("code",[t._v("Github Actions")]),t._v("，自定义 GitHub action 进行部署，完全由您编写的工作流文件决定怎么部署。")])]),t._v(" "),n("p",[t._v("我们先讲一下 "),n("code",[t._v("Deploy from a branch")]),t._v("，从分支部署，后面再讲 Github Actions.")]),t._v(" "),n("h3",{attrs:{id:"创建-github-代码仓库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建-github-代码仓库"}},[t._v("#")]),t._v(" 创建 GitHub 代码仓库")]),t._v(" "),n("p",[t._v("在 GitHub 创建一个 Sudoku 代码仓库，在本地创建一个 Sudoku 项目，然后设置 GitHub 代码仓库的地址，然后提交代码并推送到 GitHub 代码仓库。")]),t._v(" "),n("h3",{attrs:{id:"配置-github-pages"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-github-pages"}},[t._v("#")]),t._v(" 配置 GitHub Pages")]),t._v(" "),n("p",[t._v("配置 GitHub Pages：")]),t._v(" "),n("ol",[n("li",[t._v('点击 "Settings" > "Pages"')]),t._v(" "),n("li",[t._v('"Source" 选择 "Deploy from a branch"')]),t._v(" "),n("li",[t._v('"Branch" 我们先选择 "main"，点击 "Save"。')])]),t._v(" "),n("p",[n("img",{attrs:{src:a(352),alt:""}})]),t._v(" "),n("p",[t._v("GitHub 将会自动创建一个叫 "),n("code",[t._v("pages-build-deployment")]),t._v(" 的 GitHub action，并且运行一次。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(353),alt:""}})]),t._v(" "),n("p",[t._v("这个 GitHub action 由三个 job 组成")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("build")]),t._v("，拉取分支代码，使用 "),n("a",{attrs:{href:"https://jekyllrb.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jekyll"),n("OutboundLink")],1),t._v(" 构建出静态页面，将静态页面，上传到 GitHub 服务器")]),t._v(" "),n("li",[n("code",[t._v("report-build-status")]),t._v("，报告构建结果")]),t._v(" "),n("li",[n("code",[t._v("deploy")]),t._v("，部署 GitHub Pages")])]),t._v(" "),n("blockquote",[n("p",[t._v("后面讲 Github Actions 再来详细解析析这个 GitHub action.")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(354),alt:""}})]),t._v(" "),n("p",[t._v("因为我的 "),n("code",[t._v("github.io")]),t._v(" 配置了域名，所以我的代码仓库 pages 自动添加了域名。因为我们刚才选的是 "),n("code",[t._v("main")]),t._v(" 分支，"),n("a",{attrs:{href:"https://jekyllrb.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jekyll"),n("OutboundLink")],1),t._v(" 将使用项目里的 "),n("code",[t._v("index.html")]),t._v(" 或者 "),n("code",[t._v("README.md")]),t._v(" 文件构建静态页面，然后部署到 GitHub Pages.")]),t._v(" "),n("p",[t._v("而且以后我们只要推送更新到 "),n("code",[t._v("main")]),t._v(" 分支，"),n("code",[t._v("pages-build-deployment")]),t._v(" 将会重新运行，从而重新部署。")]),t._v(" "),n("blockquote",[n("p",[t._v("关于怎么配置 Jekyll，请参考 "),n("a",{attrs:{href:"https://jekyllrb.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jekyll 官方文档"),n("OutboundLink")],1)])]),t._v(" "),n("h3",{attrs:{id:"手动部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#手动部署"}},[t._v("#")]),t._v(" 手动部署")]),t._v(" "),n("p",[t._v("有些项目生成 "),n("code",[t._v("README.md")]),t._v(" 静态页面就行了，但是这不是我们这个项目的目的。我们需要编译前端工程，然后使用编译后的文件来部署 GitHub Pages。")]),t._v(" "),n("p",[t._v("首先我们创建 "),n("code",[t._v("gh-pages")]),t._v(" 分支，然后在 Pages 的配置页面选择 "),n("code",[t._v("gh-pages")]),t._v(" 分支并保存。")]),t._v(" "),n("p",[t._v("然后去到工程目录，运行")]),t._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("然后将编译后的文件提交到这个分支")]),t._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" dist\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" init \n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" -A\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deploy"')]),t._v("\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push -f git@github.com:cp3hnu/Sudoku.git main:gh-pages\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("blockquote",[n("p",[t._v("也可以使用 "),n("a",{attrs:{href:"https://github.com/tschaub/gh-pages",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("gh-pages")]),n("OutboundLink")],1),t._v(" 命令行工具")])]),t._v(" "),n("p",[t._v("当 "),n("code",[t._v("gh-pages")]),t._v(" 分支代码更新后，"),n("code",[t._v("pages-build-deployment")]),t._v(" 会自动运行，然后部署。使用这种方式就不再需要 "),n("a",{attrs:{href:"https://jekyllrb.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jekyll"),n("OutboundLink")],1),t._v(" 了，可以在 "),n("code",[t._v("gh-pages")]),t._v(" 分支里添加一个空文件 "),n("code",[t._v(".nojekyll")]),t._v(" 来取消 Jekyll 构建。")]),t._v(" "),n("p",[t._v("因为经常需要部署，因此可以写一个脚本："),n("code",[t._v("deploy.sh")])]),t._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env sh")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 确保脚本抛出遇到的错误")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" -e\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成静态文件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入生成的文件夹")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" dist\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" init\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" -A\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'deploy'")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果发布到 https://<USERNAME>.github.io")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push -f git@github.com:cp3hnu/Sudoku.git main:gh-pages\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" -\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br")])]),n("p",[t._v("给 "),n("code",[t._v("deploy.sh")]),t._v(" 文件添加执行权限")]),t._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("755")]),t._v(" deploy.sh\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("在 "),n("code",[t._v("package.json")]),t._v(" 里添加脚本命令")]),t._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"deploy"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./deploy.sh"')]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("p",[t._v("这样只要运行 "),n("code",[t._v("deploy")]),t._v(" 命令，就能成功部署了您的 Web 应用")]),t._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run deploy\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[n("img",{attrs:{src:a(355),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"yaml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#yaml"}},[t._v("#")]),t._v(" YAML")]),t._v(" "),n("p",[t._v("学习 GitHub Actions 之前，我们先来学习一下 "),n("a",{attrs:{href:"https://yaml.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("YAML"),n("OutboundLink")],1),t._v("，因为 GitHub Actions 是用 YAML 编写的。")]),t._v(" "),n("p",[t._v("YAML 是一种数据序列化语言，它是 JSON 的严格超集，在语法上添加了缩进和换行，但是不允许使用制表符进行缩进。YAML 多用于配置文件中。")]),t._v(" "),n("h3",{attrs:{id:"yaml-vs-json"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#yaml-vs-json"}},[t._v("#")]),t._v(" YAML vs JSON")]),t._v(" "),n("p",[t._v("YAML 与 JSON 显著的不同之处：")]),t._v(" "),n("ul",[n("li",[t._v("YAML 使用空格缩进（一般是 2 个空格，不允许使用 tab）表示层级关系，JSON 使用 "),n("code",[t._v("{}")])]),t._v(" "),n("li",[t._v("YAML 中的 key 不需要双引号")]),t._v(" "),n("li",[t._v("YAML 中数组元素是用带缩进的破折号（-）表示，JSON 使用 "),n("code",[t._v("[]")])]),t._v(" "),n("li",[t._v("YAML 使用 "),n("code",[t._v("#")]),t._v(" 表示注释，而 JSON 不允许注释")]),t._v(" "),n("li",[t._v("YAML  适合配置文件，JSON 适合数据传输")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(356),alt:"github-actions-json-vs-yaml"}})]),t._v(" "),n("h3",{attrs:{id:"教程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#教程"}},[t._v("#")]),t._v(" 教程")]),t._v(" "),n("p",[t._v("YAML 文件可以支持多个文档。YAML 文档以三个破折号（-）开始，以三个点（.）结束（可选）。")]),t._v(" "),n("p",[t._v("下面是一个简单的 YAML 文件")]),t._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("doe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a deer, a female deer"')]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ray")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a drop of golden sun"')]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("pi")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.14159")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("xmas")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("french-hens")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This is a list")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("calling-birds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" huey\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" dewey\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" louie\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" fred\n "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("xmas-fifth-day")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   calling"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("birds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" four\n   french"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hens")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n   golden"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rings")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n   partridges"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n     count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n     location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a pear tree"')]),t._v("\n   turtle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("doves")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" two\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br")])]),n("p",[t._v("对应的 JSON 文件是")]),t._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"doe"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a deer, a female deer"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ray"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a drop of golden sun"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pi"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.14159")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"xmas"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"french-hens"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"calling-birds"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"huey"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dewey"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"louie"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fred"')]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"xmas-fifth-day"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"calling-birds"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"four"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"french-hens"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"golden-rings"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"partridges"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"count"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"location"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a pear tree"')]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"turtle-doves"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"two"')]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br")])]),n("p",[t._v("YAML 的详细教程请参考 "),n("a",{attrs:{href:"https://learnxinyminutes.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Learn X in Y minutes"),n("OutboundLink")],1),t._v(" 和 "),n("a",{attrs:{href:"https://www.cloudbees.com/blog/yaml-tutorial-everything-you-need-get-started",target:"_blank",rel:"noopener noreferrer"}},[t._v("YAML Tutorial: Everything You Need to Get Started in Minutes"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"github-actions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#github-actions"}},[t._v("#")]),t._v(" Github Actions")]),t._v(" "),n("p",[t._v("上面我们实现了手动部署我们的 Web 应用，但是还是比较麻烦。我们每次修改完代码、提交代码，还要运行部署命令。那有没有可能我们提交代码到 "),n("code",[t._v("main")]),t._v(" 分支后，Github 自动从 "),n("code",[t._v("main")]),t._v(" 分支编译，把编译后的文件自动推送到 "),n("code",[t._v("gh-pages")]),t._v(" 分支，然后依靠 "),n("code",[t._v("pages-build-deployment")]),t._v(" action，实现部署呢？答案是可以的，那就是通过 Github Actions。")]),t._v(" "),n("p",[t._v("实现上面的方案之前，我们先来学习一下 Github Actions。")]),t._v(" "),n("p",[t._v("GitHub Actions 是一个持续集成和持续部署（CI/CD）平台，允许您自动化构建、测试和部署。")]),t._v(" "),n("p",[t._v("一个 GitHub Action 由一个工作流（"),n("strong",[t._v("workflow")]),t._v("）定义，工作流由多个作业（"),n("strong",[t._v("job")]),t._v("）组成，而作业又是由多个步骤（"),n("strong",[t._v("step")]),t._v("）组成的，一个步骤可以是一个命令、自定义脚本或操作（"),n("strong",[t._v("action")]),t._v("，即 GitHub Actions 自定义应用程序）。当存储库中发生事件（"),n("strong",[t._v("event")]),t._v("）时（比如提交代码到仓库），就会在虚拟机运行器（"),n("strong",[t._v("runner")]),t._v("）或容器内运行工作流的作业。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(357),alt:""}})]),t._v(" "),n("p",[t._v("工作流是由 "),n("a",{attrs:{href:"https://yaml.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("YAML"),n("OutboundLink")],1),t._v(" 文件定义，存储在代码仓库的 "),n("code",[t._v(".github/workflows")]),t._v(" 目录里。一个代码仓库可以有多个工作流，每个工作流可以执行一组不同的任务。")]),t._v(" "),n("p",[t._v("GitHub 提供了很多的"),n("a",{attrs:{href:"https://github.com/actions/starter-workflows",target:"_blank",rel:"noopener noreferrer"}},[t._v("工作流模板"),n("OutboundLink")],1),t._v("，当您在 GitHub 上创建新的工作流时，GitHub 会提示您选择工作流模板，以此来帮助您快速创建工作流。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(358),alt:"github-actions-starter-workflows"}})]),t._v(" "),n("h3",{attrs:{id:"事件-event"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#事件-event"}},[t._v("#")]),t._v(" 事件 Event")]),t._v(" "),n("p",[t._v("GitHub 的工作流由事件触发的，比如推送提交时触发工作流使用 "),n("code",[t._v("push")]),t._v(" 事件")]),t._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  push\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),n("p",[t._v("还可以限定推送到哪个分支才触发工作流，比如下面是当推送到 "),n("code",[t._v("main")]),t._v(" 或以 "),n("code",[t._v("releases/")]),t._v(" 开头的分支时，触发工作流")]),t._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'main'")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'releases/**'")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("p",[t._v("GitHub Actions 定义了多个事件，详情请参考"),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/choosing-when-your-workflow-runs/triggering-a-workflow#using-filters",target:"_blank",rel:"noopener noreferrer"}},[t._v("触发工作流程"),n("OutboundLink")],1),t._v("和"),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/choosing-when-your-workflow-runs/events-that-trigger-workflows",target:"_blank",rel:"noopener noreferrer"}},[t._v("触发工作流的事件"),n("OutboundLink")],1),t._v("。")]),t._v(" "),n("h3",{attrs:{id:"作业-job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#作业-job"}},[t._v("#")]),t._v(" 作业 Job")]),t._v(" "),n("p",[t._v("工作流由一个或多个作业组成。默认情况下这些作业并行运行的，若要按顺序运行作业，可以使用 "),n("code",[t._v("needs")]),t._v(" 选项定义作业之间的依赖关系。")]),t._v(" "),n("p",[t._v("每个作业必须有一个唯一标识符 "),n("code",[t._v("job_id")]),t._v("，"),n("code",[t._v("job_id")]),t._v(" 是一个字符串，必须以字母或 "),n("code",[t._v("_")]),t._v(" 开头，并且只能包含字母数字、"),n("code",[t._v("-")]),t._v(" 或 "),n("code",[t._v("_")]),t._v("。")]),t._v(" "),n("p",[t._v("每个作业通过 "),n("code",[t._v("name")]),t._v(" 设置名称，"),n("code",[t._v("runs-on")]),t._v(" 指定运行器，"),n("code",[t._v("steps")]),t._v(" 设置步骤/任务。")]),t._v(" "),n("p",[t._v("下面创建了一个 "),n("code",[t._v("build")]),t._v(' 的作业，名称是 "My Job"，运行在 '),n("code",[t._v("ubuntu-latest")]),t._v(" 上，只有一个任务就是安装 npm 依赖：")]),t._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  \t"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" My Job\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    \t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Install dependencies\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm install\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br")])]),n("p",[t._v("关于作业的详细介绍请参考在"),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/choosing-what-your-workflow-does/using-jobs-in-a-workflow",target:"_blank",rel:"noopener noreferrer"}},[t._v("工作流程中使用作业 "),n("OutboundLink")],1),t._v("和 "),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/workflow-syntax-for-github-actions#jobs",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jobs 语法"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"步骤-step"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#步骤-step"}},[t._v("#")]),t._v(" 步骤 Step")]),t._v(" "),n("p",[t._v("步骤就是作业的一个任务，一个作业可以包含一系列任务。步骤可以是一个简单命令、一段自定义脚本或者 GitHub Actions 自定义应用程序。")]),t._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("my-job")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" My Job\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Run a command\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm install\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Run a script\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./scripts/my.sh\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Run a GitHub action\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v2\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br")])]),n("p",[t._v("关于步骤的详细介绍请参考在 "),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/choosing-what-your-workflow-does/workflow-commands-for-github-actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Actions 的工作流命令"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/choosing-what-your-workflow-does/adding-scripts-to-your-workflow",target:"_blank",rel:"noopener noreferrer"}},[t._v("添加脚本到工作流程"),n("OutboundLink")],1),t._v("和 "),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/workflow-syntax-for-github-actions#jobsjob_idsteps",target:"_blank",rel:"noopener noreferrer"}},[t._v("Steps 语法"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"操作-action"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#操作-action"}},[t._v("#")]),t._v(" 操作 Action")]),t._v(" "),n("p",[t._v("这里的操作是指 GitHub Actions 自定义应用程序，是一组预先创建的可重用作业或代码，用于在工作流中执行特定任务。")]),t._v(" "),n("p",[t._v("操作可以是 GitHub Actions 官方的，比如 "),n("a",{attrs:{href:"https://github.com/actions/checkout",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/checkout")]),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"https://github.com/actions/setup-node",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/setup-node")]),n("OutboundLink")],1),t._v(" 等，也可以是社区的，比如 "),n("a",{attrs:{href:"https://github.com/peaceiris/actions-gh-pages",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("peaceiris/actions-gh-pages")]),n("OutboundLink")],1),t._v("，同时我们也可以创建自己的操作。")]),t._v(" "),n("p",[t._v("可以通过 "),n("a",{attrs:{href:"https://github.com/marketplace/actions/",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Marketplace"),n("OutboundLink")],1),t._v(" 来查找 GitHub 社区创建的操作。")]),t._v(" "),n("ol",[n("li",[t._v("在代码仓库中，打开要编辑的工作流程文件")]),t._v(" "),n("li",[t._v("打开工作流编辑器")]),t._v(" "),n("li",[t._v("在编辑器右侧，使用 GitHub Marketplace 边栏浏览操作。 其中带有徽章的操作是 GitHub 已验证其创建者是合作伙伴组织")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(359),alt:"github-actions-marketplace"}})]),t._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[t._v("找到要使用的操作")]),t._v(" "),n("li",[t._v("单击操作，查看操作详情")]),t._v(" "),n("li",[t._v('在"安装"下，复制工作流语法，添加到您的工作流文件中')])]),t._v(" "),n("p",[t._v("关于操作的详细介绍请参考"),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/choosing-what-your-workflow-does/using-pre-written-building-blocks-in-your-workflow",target:"_blank",rel:"noopener noreferrer"}},[t._v("工作流中使用预编写的构建基块"),n("OutboundLink")],1),t._v("。")]),t._v(" "),n("h4",{attrs:{id:"常用的-action"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用的-action"}},[t._v("#")]),t._v(" 常用的 Action")]),t._v(" "),n("h5",{attrs:{id:"actions-checkout"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#actions-checkout"}},[t._v("#")]),t._v(" "),n("code",[t._v("actions/checkout")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/actions/checkout",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/checkout")]),n("OutboundLink")],1),t._v(" 在 "),n("code",[t._v("$GITHUB_WORKSPACE")]),t._v(" 下 checkout 您的仓库代码，以便您的工作流程可以访问它。")]),t._v(" "),n("h5",{attrs:{id:"actions-setup-node"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#actions-setup-node"}},[t._v("#")]),t._v(" "),n("code",[t._v("actions/setup-node")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/actions/setup-node",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/setup-node")]),n("OutboundLink")],1),t._v(" 设置 Node 环境，提供以下功能：")]),t._v(" "),n("ul",[n("li",[t._v("下载和缓存 Node.js，并将其添加到 PATH")]),t._v(" "),n("li",[t._v("缓存 npm/yarn/pnpm 依赖项")]),t._v(" "),n("li",[t._v("为错误输出注册问题匹配器")]),t._v(" "),n("li",[t._v("为 GPR 或 npm 配置身份验证")])]),t._v(" "),n("p",[n("code",[t._v("actions/setup-node")]),t._v(" 使用 "),n("a",{attrs:{href:"https://github.com/actions/cache",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/cache")]),n("OutboundLink")],1),t._v(" 缓存全局包数据，注意这个缓存不是缓存 "),n("code",[t._v("node_modules")]),t._v(" 里的依赖包，具体是什么数据还需要进一步研究。")]),t._v(" "),n("h5",{attrs:{id:"actions-upload-artifact"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#actions-upload-artifact"}},[t._v("#")]),t._v(" "),n("code",[t._v("actions/upload-artifact")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/actions/upload-artifact",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/upload-artifact")]),n("OutboundLink")],1),t._v(" 从工作流程运行中上传"),n("a",{attrs:{href:"https://docs.github.com/en/actions/using-workflows/storing-workflow-data-as-artifacts",target:"_blank",rel:"noopener noreferrer"}},[t._v("操作构件"),n("OutboundLink")],1),t._v("。")]),t._v(" "),n("h5",{attrs:{id:"actions-download-artifact"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#actions-download-artifact"}},[t._v("#")]),t._v(" "),n("code",[t._v("actions/download-artifact")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/actions/download-artifact",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/download-artifact")]),n("OutboundLink")],1),t._v(" 从工作流程运行中下载"),n("a",{attrs:{href:"https://docs.github.com/en/actions/using-workflows/storing-workflow-data-as-artifacts",target:"_blank",rel:"noopener noreferrer"}},[t._v("操作构件"),n("OutboundLink")],1),t._v("。")]),t._v(" "),n("h5",{attrs:{id:"actions-upload-pages-artifact"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#actions-upload-pages-artifact"}},[t._v("#")]),t._v(" "),n("code",[t._v("actions/upload-pages-artifact")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/actions/upload-pages-artifact",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/upload-pages-artifact")]),n("OutboundLink")],1),t._v(" 打包和上传可部署到 "),n("a",{attrs:{href:"https://pages.github.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Pages"),n("OutboundLink")],1),t._v(" 的构件，内部使用 "),n("code",[t._v("actions/upload-artifact")]),t._v(" 上传构件。")]),t._v(" "),n("h5",{attrs:{id:"actions-configure-pages"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#actions-configure-pages"}},[t._v("#")]),t._v(" "),n("code",[t._v("actions/configure-pages")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/actions/configure-pages",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/configure-pages")]),n("OutboundLink")],1),t._v(" 启用 "),n("a",{attrs:{href:"https://pages.github.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Pages"),n("OutboundLink")],1),t._v(" 并提取有关站点的各种元数据。它还可用于配置 GitHub 支持的作为"),n("a",{attrs:{href:"https://github.com/actions/starter-workflows/tree/main/pages",target:"_blank",rel:"noopener noreferrer"}},[t._v("入门工作流程"),n("OutboundLink")],1),t._v("的各种静态站点生成器。")]),t._v(" "),n("h5",{attrs:{id:"actions-deploy-pages"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#actions-deploy-pages"}},[t._v("#")]),t._v(" "),n("code",[t._v("actions/deploy-pages")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.github.com/actions/deploy-pages",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/deploy-pages")]),n("OutboundLink")],1),t._v(" 部署 "),n("a",{attrs:{href:"https://docs.github.com/en/actions/using-workflows/storing-workflow-data-as-artifacts",target:"_blank",rel:"noopener noreferrer"}},[t._v("操作构建"),n("OutboundLink")],1),t._v(" 到 "),n("a",{attrs:{href:"https://pages.github.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Pages"),n("OutboundLink")],1),t._v(".")]),t._v(" "),n("h5",{attrs:{id:"peaceiris-actions-gh-pages"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#peaceiris-actions-gh-pages"}},[t._v("#")]),t._v(" "),n("code",[t._v("peaceiris/actions-gh-pages")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/peaceiris/actions-gh-pages",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("peaceiris/actions-gh-pages")]),n("OutboundLink")],1),t._v(" 操作用于将静态文件上传的 "),n("code",[t._v("gh-pages")]),t._v(" 分支。此操作通常用于"),n("a",{attrs:{href:"https://jamstack.org/generators/",target:"_blank",rel:"noopener noreferrer"}},[t._v("静态站点生成器"),n("OutboundLink")],1),t._v("来进行部署。")]),t._v(" "),n("h3",{attrs:{id:"运行器-runner"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#运行器-runner"}},[t._v("#")]),t._v(" 运行器 Runner")]),t._v(" "),n("p",[t._v("在作业中通过 "),n("code",[t._v("runs-on")]),t._v(" 指定运行器，GitHub Actions 支持 GitHub 托管的运行器、大型运行器 或自托管运行器。")]),t._v(" "),n("p",[t._v("用于公共代码库的 GitHub 托管的运行器包括下面这些")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("strong",[t._v("虚拟机")])]),t._v(" "),n("th",[n("strong",[t._v("处理器 (CPU)")])]),t._v(" "),n("th",[n("strong",[t._v("内存 (RAM)")])]),t._v(" "),n("th",[n("strong",[t._v("存储 (SSD)")])]),t._v(" "),n("th",[n("strong",[t._v("工作流标签")])])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("Linux")]),t._v(" "),n("td",[t._v("4")]),t._v(" "),n("td",[t._v("16 GB")]),t._v(" "),n("td",[t._v("14 GB")]),t._v(" "),n("td",[n("code",[t._v("ubuntu-latest")]),t._v("，"),n("code",[t._v("ubuntu-24.04")]),t._v("，"),n("code",[t._v("ubuntu-22.04")]),t._v("，"),n("code",[t._v("ubuntu-20.04")])])]),t._v(" "),n("tr",[n("td",[t._v("Windows")]),t._v(" "),n("td",[t._v("4")]),t._v(" "),n("td",[t._v("16 GB")]),t._v(" "),n("td",[t._v("14 GB")]),t._v(" "),n("td",[n("code",[t._v("windows-latest")]),t._v("，"),n("code",[t._v("windows-2022")]),t._v("，"),n("code",[t._v("windows-2019")])])]),t._v(" "),n("tr",[n("td",[t._v("macOS")]),t._v(" "),n("td",[t._v("3")]),t._v(" "),n("td",[t._v("14 GB")]),t._v(" "),n("td",[t._v("14 GB")]),t._v(" "),n("td",[n("code",[t._v("macos-12")])])]),t._v(" "),n("tr",[n("td",[t._v("macOS")]),t._v(" "),n("td",[t._v("4")]),t._v(" "),n("td",[t._v("14 GB")]),t._v(" "),n("td",[t._v("14 GB")]),t._v(" "),n("td",[n("code",[t._v("macos-13")])])]),t._v(" "),n("tr",[n("td",[t._v("macOS")]),t._v(" "),n("td",[t._v("3 (M1)")]),t._v(" "),n("td",[t._v("7 GB")]),t._v(" "),n("td",[t._v("14 GB")]),t._v(" "),n("td",[n("code",[t._v("macos-latest")]),t._v("、"),n("code",[t._v("macos-14")]),t._v("、"),n("code",[t._v("macos-15")])])])])]),t._v(" "),n("blockquote",[n("p",[t._v("📢："),n("code",[t._v("-latest")]),t._v(" 运行器是 GitHub 提供的最新稳定映像，但可能不是操作系统供应商提供的最新版本的操作系统。")])]),t._v(" "),n("p",[t._v("关于运行器的详细介绍请参考"),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/choosing-where-your-workflow-runs/choosing-the-runner-for-a-job#choosing-github-hosted-runners",target:"_blank",rel:"noopener noreferrer"}},[t._v("选择作业的运行器"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/choosing-where-your-workflow-runs/running-jobs-in-a-container",target:"_blank",rel:"noopener noreferrer"}},[t._v("在容器中运行作业"),n("OutboundLink")],1),t._v("和"),n("a",{attrs:{href:"https://docs.github.com/zh/actions/writing-workflows/choosing-what-your-workflow-does/running-variations-of-jobs-in-a-workflow",target:"_blank",rel:"noopener noreferrer"}},[t._v("在工作流中运行作业的变体"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"更多配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#更多配置"}},[t._v("#")]),t._v(" 更多配置")]),t._v(" "),n("p",[t._v("上面只是介绍了工作流的重要组成部分，其实工作流还有很多内容，比如变量、环境、上下文、并发、权限、工作流命令、安全性等等，更多详情请参考 "),n("a",{attrs:{href:"https://docs.github.com/en/actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Actions 文档"),n("OutboundLink")],1),t._v("。")]),t._v(" "),n("h2",{attrs:{id:"自动部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自动部署"}},[t._v("#")]),t._v(" 自动部署")]),t._v(" "),n("p",[t._v("学会了 GitHub Actions 和 YAML 之后，我们来创建一个自动部署的 GitHub action，实现这些功能：当我们提交代码并推送到 "),n("code",[t._v("main")]),t._v(" 分支时，GitHub 自动编译我们的应用，并将编译后的文件提交并推送到 "),n("code",[t._v("gh-pages")]),t._v(" 分支，这个时候 GitHub 的  "),n("code",[t._v("pages-build-deployment")]),t._v(" 的 action 就会运行，部署我们的应用。")]),t._v(" "),n("p",[t._v("首先在项目里创建 "),n("code",[t._v(".github/workflows")]),t._v(" 目录，然后创建 "),n("code",[t._v("deploy.yml")]),t._v(" 文件或者 "),n("code",[t._v("deploy.yaml")]),t._v(" （文件名可以随便取），输入下面的代码。")]),t._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# deploy.yml")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy to GitHub Pages\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" main "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当推送到 main 分支时触发")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout code\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v4\n\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Set up Node.js\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/setup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("node@v4\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node-version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"16"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 你可以根据项目需要调整 Node.js 版本")]),t._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Install dependencies\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" yarn install "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果使用的是其他包管理工具，调整命令")]),t._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Build the project\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm run build "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建项目，确保构建输出到指定目录（如 ./dist）")]),t._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy to GitHub Pages\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" peaceiris/actions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("gh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages@v4 "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用于将构建产物推送到 gh-pages 分支")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("github_token")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITHUB_TOKEN "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 内置 GitHub Token，用于授权操作")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("publish_branch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 部署的分支")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("publish_dir")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./dist "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建后的输出目录，根据项目调整（如 ./dist）")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br")])]),n("p",[t._v("提交代码并推送的 GitHub 仓库，这个时候在仓库的 "),n("code",[t._v("Actions")]),t._v(" 页签下就能看到我们刚才创建的 GitHub action了，并且会自动运行一次，而且以后只要推送代码到 "),n("code",[t._v("main")]),t._v(" 分支，该  GitHub action 都会自动运行，从而更新我们的应用。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(360),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"更进一步"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#更进一步"}},[t._v("#")]),t._v(" 更进一步")]),t._v(" "),n("p",[t._v("上面的自动部署的 GitHub action 是将编译后的文件推送到 "),n("code",[t._v("gh-pages")]),t._v(" 分支，然后再依靠 GitHub 的  "),n("code",[t._v("pages-build-deployment")]),t._v(" 实现部署，其实我们可以跳过 "),n("code",[t._v("pages-build-deployment")]),t._v("，直接部署。我们需要创建一个 GitHub action，实现以下功能：当我们修改代码并推送到 "),n("code",[t._v("main")]),t._v(" 分支时，Github action 自动编译我们的应用，并且直接部署到 GitHub Pages。")]),t._v(" "),n("p",[t._v("首先修改 Pages 配置：")]),t._v(" "),n("ol",[n("li",[t._v('点击 "Settings" > "Pages"')]),t._v(" "),n("li",[t._v('"Source" 选择 "GitHub Actions"')])]),t._v(" "),n("p",[t._v("然后修改 "),n("code",[t._v("deploy.yml")]),t._v(" 文件。")]),t._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建并将其部署到 GitHub Pages")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy to GitHub Pages\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在针对 `main` 分支的推送上运行。如果你")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用 `master` 分支作为默认分支，请将其更改为 `master`")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许你从 Actions 选项卡手动运行此工作流程")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("workflow_dispatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置 GITHUB_TOKEN 的权限，以允许部署到 GitHub Pages")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("permissions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("contents")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" read\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("pages")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" write\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("id-token")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" write\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只允许同时进行一次部署，跳过正在运行和最新队列之间的运行队列")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 但是，不要取消正在进行的运行，因为我们希望允许这些生产部署完成")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("concurrency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("group")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pages\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cancel-in-progress")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建作业")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v4\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Setup Node\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/setup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("node@v4\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node-version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cache")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或 pnpm / yarn")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Setup Pages\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/configure"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages@v4\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Install dependencies\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm ci "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或 pnpm install / yarn install / bun install")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Build\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm run build\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Upload artifact\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/upload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("artifact@v3\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" dist\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 部署作业")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("deploy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" github"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" steps.deployment.outputs.page_url "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("needs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" build\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" deploy\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy to GitHub Pages\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" deployment\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/deploy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages@v4\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br"),n("span",{staticClass:"line-number"},[t._v("41")]),n("br"),n("span",{staticClass:"line-number"},[t._v("42")]),n("br"),n("span",{staticClass:"line-number"},[t._v("43")]),n("br"),n("span",{staticClass:"line-number"},[t._v("44")]),n("br"),n("span",{staticClass:"line-number"},[t._v("45")]),n("br"),n("span",{staticClass:"line-number"},[t._v("46")]),n("br"),n("span",{staticClass:"line-number"},[t._v("47")]),n("br"),n("span",{staticClass:"line-number"},[t._v("48")]),n("br"),n("span",{staticClass:"line-number"},[t._v("49")]),n("br"),n("span",{staticClass:"line-number"},[t._v("50")]),n("br"),n("span",{staticClass:"line-number"},[t._v("51")]),n("br"),n("span",{staticClass:"line-number"},[t._v("52")]),n("br"),n("span",{staticClass:"line-number"},[t._v("53")]),n("br"),n("span",{staticClass:"line-number"},[t._v("54")]),n("br"),n("span",{staticClass:"line-number"},[t._v("55")]),n("br"),n("span",{staticClass:"line-number"},[t._v("56")]),n("br"),n("span",{staticClass:"line-number"},[t._v("57")]),n("br"),n("span",{staticClass:"line-number"},[t._v("58")]),n("br"),n("span",{staticClass:"line-number"},[t._v("59")]),n("br")])]),n("p",[t._v("这个工作流文件有两个作业，"),n("code",[t._v("build")]),t._v(" 和 "),n("code",[t._v("deploy")]),t._v("。")]),t._v(" "),n("p",[n("code",[t._v("build")]),t._v(" 是构建作业，负责：")]),t._v(" "),n("ol",[n("li",[n("p",[n("code",[t._v("actions/checkout")]),t._v(" 拉取代码")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("actions/setup-node")]),t._v(" 设置 Node 环境，版本是 "),n("code",[t._v("v20.x")]),t._v("，并且进行缓存（注意缓存的依赖不是 "),n("code",[t._v("node_modules")]),t._v("）")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("actions/configure-pages")]),t._v(" 启用 GitHub Pages")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("npm ci")]),t._v(" 安装依赖")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("actions/upload-pages-artifact")]),t._v(" 打包和上传构件")])])]),t._v(" "),n("p",[n("code",[t._v("deploy")]),t._v(" 是部署作业，它依赖 "),n("code",[t._v("build")]),t._v(" 作业，只有一个任务，使用 "),n("code",[t._v("actions/deploy-pages")]),t._v(" 将 "),n("code",[t._v("build")]),t._v(" 上传的构件部署到 GitHub Pages.")]),t._v(" "),n("p",[t._v("最后提交代码并推送到 GitHub 仓库，然后 GitHub 就运行这个 GitHub action，直接编译并部署我们的应用到 GitHub Pages，不再需要 "),n("code",[t._v("pages-build-deployment")]),t._v(" GitHub action 了。")]),t._v(" "),n("h2",{attrs:{id:"解析-pages-build-deployment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#解析-pages-build-deployment"}},[t._v("#")]),t._v(" 解析 "),n("code",[t._v("pages-build-deployment")])]),t._v(" "),n("p",[t._v("前面讲到选择从分支部署 GitHub Pages 时，GitHub 会自动创建一个 GitHub Action "),n("code",[t._v("pages-build-deployment")]),t._v("，现在我们来分析一下这个 GitHub action")]),t._v(" "),n("p",[n("code",[t._v("pages-build-deployment")]),t._v(" GitHub action 由三个 job 组成")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("build")]),t._v("，拉取分支代码，使用 "),n("a",{attrs:{href:"https://jekyllrb.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jekyll"),n("OutboundLink")],1),t._v(" 构建出静态页面，将静态页面，上传到 GitHub 服务器")]),t._v(" "),n("li",[n("code",[t._v("report-build-status")]),t._v("，报告构建结果")]),t._v(" "),n("li",[n("code",[t._v("deploy")]),t._v("，部署 GitHub Pages")])]),t._v(" "),n("p",[t._v("其中最重要的就是 "),n("code",[t._v("build")]),t._v(" 和 "),n("code",[t._v("deploy")]),t._v(" 作业。")]),t._v(" "),n("p",[t._v("其中 "),n("code",[t._v("build")]),t._v(" 的任务如下图所示：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(361),alt:"github-actions-default-build"}})]),t._v(" "),n("p",[n("code",[t._v("build")]),t._v(" 上面我们创建的工作流 "),n("code",[t._v("build")]),t._v(" 类似:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("Set up job")]),t._v("：建立作业，主要是设置作业的运行器、权限、下载后面要用到的 action")]),t._v(" "),n("li",[t._v("下载 "),n("code",[t._v("ghcr.io/actions/jekyll-build-pages:v1.0.13")]),t._v(" 镜像")]),t._v(" "),n("li",[n("code",[t._v("Checkout")]),t._v("，使用 "),n("code",[t._v("actions/checkout")]),t._v(" action 拉取代码")]),t._v(" "),n("li",[n("code",[t._v("Build with JekyII")]),t._v("，使用 "),n("a",{attrs:{href:"https://github.com/actions/jekyll-build-pages",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/jekyll-build-pages")]),n("OutboundLink")],1),t._v(" 编译构件")]),t._v(" "),n("li",[n("code",[t._v("Upload artifact")]),t._v("，使用"),n("code",[t._v("actions/upload-pages-artifact")]),t._v(" 打包和上传构件")])]),t._v(" "),n("p",[t._v("而 "),n("code",[t._v("deploy")]),t._v(" 和我们创建的工作流一模一样，使用 "),n("code",[t._v("actions/deploy-pages")]),t._v(" 将 "),n("code",[t._v("build")]),t._v(" 上传的构件部署到 GitHub Pages.")]),t._v(" "),n("h2",{attrs:{id:"总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),n("p",[t._v("今天我们学习了 "),n("a",{attrs:{href:"https://docs.github.com/en/pages",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Pages"),n("OutboundLink")],1),t._v(" 和 "),n("a",{attrs:{href:"https://docs.github.com/en/actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Actions"),n("OutboundLink")],1),t._v("，知道了怎么手动部署和自动部署我们的 Web 前端应用。GitHub Actions 功能非常强大，我们只用了其中一小部分的功能，可谓是冰山一角，更多的功能值得我们继续学习、研究、探索。")]),t._v(" "),n("h2",{attrs:{id:"代码仓库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码仓库"}},[t._v("#")]),t._v(" 代码仓库")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/cp3hnu/Sudoku",target:"_blank",rel:"noopener noreferrer"}},[t._v("cp3hnu/Sudoku"),n("OutboundLink")],1)]),t._v(" "),n("h1",{attrs:{id:"references"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[t._v("#")]),t._v(" References")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://docs.github.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Docs"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://docs.github.com/en/pages",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Pages"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://docs.github.com/en/actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Actions"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://jekyllrb.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jekyll"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/tschaub/gh-pages",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("gh-pages")]),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/marketplace?type=actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Marketplace"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/actions/starter-workflows",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/starter-workflows")]),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/actions/checkout",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/checkout")]),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/actions/setup-node",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/setup-node")]),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/actions/upload-artifact",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/upload-artifact")]),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/actions/download-artifact",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/download-artifact")]),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/actions/configure-pages",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/configure-pages")]),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://www.github.com/actions/deploy-pages",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("actions/deploy-pages")]),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/peaceiris/actions-gh-pages",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("peaceiris/actions-gh-pages")]),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://yaml.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("YAML"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://learnxinyminutes.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Learn X in Y minutes"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://www.cloudbees.com/blog/yaml-tutorial-everything-you-need-get-started",target:"_blank",rel:"noopener noreferrer"}},[t._v("YAML Tutorial: Everything You Need to Get Started in Minutes"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"http://www.yamllint.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("YAML Lint"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://www.bairesdev.com/tools/json2yaml/",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSON ⇆ YAML"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);